(function(){var a=null;if((a||typeof djConfig!="undefined"&&djConfig.scopeMap)&&typeof window!="undefined"){for(var b="",c="",d="",j={},l={},a=a||djConfig.scopeMap,m=0;m<a.length;m++){var k=a[m];b+="var "+k[0]+" = {}; "+k[1]+" = "+k[0]+";"+k[1]+"._scopeName = '"+k[1]+"';";c+=(m==0?"":",")+k[0];d+=(m==0?"":",")+k[1];j[k[0]]=k[1];l[k[1]]=k[0]}eval(b+"dojo._scopeArgs = ["+d+"];");dojo._scopePrefixArgs=c;dojo._scopePrefix="(function("+c+"){";dojo._scopeSuffix="})("+d+")";dojo._scopeMap=j;dojo._scopeMapRev=
l}(function(){if(typeof this.loadFirebugConsole=="function")this.loadFirebugConsole();else{this.console=this.console||{};for(var f="assert,count,debug,dir,dirxml,error,group,groupEnd,info,profile,profileEnd,time,timeEnd,trace,warn,log".split(","),a=0,b;b=f[a++];)console[b]||function(){var f=b+"";console[f]="log"in console?function(){var a=Array.apply({},arguments);a.unshift(f+":");console.log(a.join(" "))}:function(){};console[f]._fake=!0}()}typeof dojo=="undefined"&&(dojo={_scopeName:"dojo",_scopePrefix:"",
_scopePrefixArgs:"",_scopeSuffix:"",_scopeMap:{},_scopeMapRev:{}});var c=dojo;typeof dijit=="undefined"&&(dijit={_scopeName:"dijit"});typeof dojox=="undefined"&&(dojox={_scopeName:"dojox"});if(!c._scopeArgs)c._scopeArgs=[dojo,dijit,dojox];c.global=this;c.config={isDebug:!1,debugAtAllCosts:!1};if(f=typeof djConfig!="undefined"?djConfig:typeof dojoConfig!="undefined"?dojoConfig:null)for(var o in f)c.config[o]=f[o];dojo.locale=c.config.locale;o="$Rev: 24595 $".match(/\d+/);dojo.version={major:1,minor:6,
patch:1,flag:"",revision:o?+o[0]:NaN,toString:function(){with(c.version)return major+"."+minor+"."+patch+flag+" ("+revision+")"}};typeof OpenAjax!="undefined"&&OpenAjax.hub.registerLibrary(dojo._scopeName,"http://dojotoolkit.org",c.version.toString());var r,d,g={};for(a in{toString:1}){r=[];break}dojo._extraNames=r=r||"hasOwnProperty,valueOf,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,constructor".split(",");d=r.length;dojo._mixin=function(f,a){var b,c,n;for(b in a)if(c=a[b],!(b in
f)||f[b]!==c&&(!(b in g)||g[b]!==c))f[b]=c;if(d&&a)for(n=0;n<d;++n)if(b=r[n],c=a[b],!(b in f)||f[b]!==c&&(!(b in g)||g[b]!==c))f[b]=c;return f};dojo.mixin=function(f,a){f||(f={});for(var b=1,g=arguments.length;b<g;b++)c._mixin(f,arguments[b]);return f};dojo._getProp=function(f,a,b){for(var b=b||c.global,g=0,n;b&&(n=f[g]);g++)g==0&&c._scopeMap[n]&&(n=c._scopeMap[n]),b=n in b?b[n]:a?b[n]={}:void 0;return b};dojo.setObject=function(f,a,b){var g=f.split("."),f=g.pop();return(b=c._getProp(g,!0,b))&&f?
b[f]=a:void 0};dojo.getObject=function(f,a,b){return c._getProp(f.split("."),a,b)};dojo.exists=function(f,a){return c.getObject(f,!1,a)!==void 0};dojo.eval=function(f){return c.global.eval?c.global.eval(f):eval(f)};c.deprecated=c.experimental=function(){}})();(function(){var f=dojo;f.mixin(f,{_loadedModules:{},_inFlightCount:0,_hasResource:{},_modulePrefixes:{dojo:{name:"dojo",value:"."},doh:{name:"doh",value:"../util/doh"},tests:{name:"tests",value:"tests"}},_moduleHasPrefix:function(a){var b=f._modulePrefixes;
return!(!b[a]||!b[a].value)},_getModulePrefix:function(a){var b=f._modulePrefixes;return f._moduleHasPrefix(a)?b[a].value:a},_loadedUrls:[],_postLoad:!1,_loaders:[],_unloaders:[],_loadNotifying:!1});dojo._loadPath=function(a,b,c){a=(a.charAt(0)=="/"||a.match(/^\w+:/)?"":f.baseUrl)+a;try{return!b?f._loadUri(a,c):f._loadUriAndCheck(a,b,c)}catch(g){return console.error(g),!1}finally{}};dojo._loadUri=function(a,b){if(f._loadedUrls[a])return!0;f._inFlightCount++;var c=f._getText(a,!0);if(c){f._loadedUrls[a]=
!0;f._loadedUrls.push(a);c=b?/^define\(/.test(c)?c:"("+c+")":f._scopePrefix+c+f._scopeSuffix;f.isIE||(c+="\r\n//@ sourceURL="+a);var g=f.eval(c);b&&b(g)}--f._inFlightCount==0&&f._postLoad&&f._loaders.length&&setTimeout(function(){f._inFlightCount==0&&f._callLoaded()},0);return!!c};dojo._loadUriAndCheck=function(a,b,c){var g=!1;try{g=f._loadUri(a,c)}catch(p){console.error("failed loading "+a+" with error: "+p)}return!(!g||!f._loadedModules[b])};dojo.loaded=function(){f._loadNotifying=!0;f._postLoad=
!0;var a=f._loaders;f._loaders=[];for(var b=0;b<a.length;b++)a[b]();f._loadNotifying=!1;f._postLoad&&f._inFlightCount==0&&a.length&&f._callLoaded()};dojo.unloaded=function(){for(var a=f._unloaders;a.length;)a.pop()()};f._onto=function(f,a,b){if(b){if(b){var g=typeof b=="string"?a[b]:b;f.push(function(){g.call(a)})}}else f.push(a)};dojo.ready=dojo.addOnLoad=function(a,b){f._onto(f._loaders,a,b);f._postLoad&&f._inFlightCount==0&&!f._loadNotifying&&f._callLoaded()};var a=f.config.addOnLoad;if(a)f.addOnLoad[a instanceof
Array?"apply":"call"](f,a);dojo._modulesLoaded=function(){f._postLoad||(f._inFlightCount>0?console.warn("files still in flight!"):f._callLoaded())};dojo._callLoaded=function(){typeof setTimeout=="object"||f.config.useXDomain&&f.isOpera?setTimeout(f.isAIR?function(){f.loaded()}:f._scopeName+".loaded();",0):f.loaded()};dojo._getModuleSymbols=function(a){for(var a=a.split("."),b=a.length;b>0;b--){var c=a.slice(0,b).join(".");if(b==1&&!f._moduleHasPrefix(c))a[0]="../"+a[0];else{var g=f._getModulePrefix(c);
if(g!=c){a.splice(0,b,g);break}}}return a};dojo._global_omit_module_check=!1;dojo.loadInit=function(f){f()};dojo._loadModule=dojo.require=function(a,b){var b=f._global_omit_module_check||b,c=f._loadedModules[a];if(c)return c;var g=f._getModuleSymbols(a).join("/")+".js";if(!f._loadPath(g,!b?a:null)&&!b)throw Error("Could not load '"+a+"'; last tried '"+g+"'");if(!b&&!f._isXDomain&&(c=f._loadedModules[a],!c))throw Error("symbol '"+a+"' is not defined after loading '"+g+"'");return c};dojo.provide=function(a){a+=
"";return f._loadedModules[a]=f.getObject(a,!0)};dojo.platformRequire=function(a){for(var a=(a.common||[]).concat(a[f._name]||a["default"]||[]),b=0;b<a.length;b++){var c=a[b];c.constructor==Array?f._loadModule.apply(f,c):f._loadModule(c)}};dojo.requireIf=function(a,b){if(a===!0){for(var c=[],g=1;g<arguments.length;g++)c.push(arguments[g]);f.require.apply(f,c)}};dojo.requireAfterIf=f.requireIf;dojo.registerModulePath=function(a,b){f._modulePrefixes[a]={name:a,value:b}};dojo.requireLocalization=function(a,
b,c,g){f.require("dojo.i18n");f.i18n._requireLocalization.apply(f.hostenv,arguments)};var b=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,c=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/;dojo._Url=function(){for(var a=arguments,i=[a[0]],d=1;d<a.length;d++)if(a[d]){var g=new f._Url(a[d]+""),i=new f._Url(i[0]+"");if(g.path==""&&!g.scheme&&!g.authority&&!g.query){if(g.fragment!=null)i.fragment=g.fragment;g=i}else if(!g.scheme&&(g.scheme=i.scheme,!g.authority&&(g.authority=
i.authority,g.path.charAt(0)!="/"))){for(var i=(i.path.substring(0,i.path.lastIndexOf("/")+1)+g.path).split("/"),p=0;p<i.length;p++)i[p]=="."?p==i.length-1?i[p]="":(i.splice(p,1),p--):p>0&&!(p==1&&i[0]=="")&&i[p]==".."&&i[p-1]!=".."&&(p==i.length-1?(i.splice(p,1),i[p-1]=""):(i.splice(p-1,2),p-=2));g.path=i.join("/")}i=[];g.scheme&&i.push(g.scheme,":");g.authority&&i.push("//",g.authority);i.push(g.path);g.query&&i.push("?",g.query);g.fragment&&i.push("#",g.fragment)}this.uri=i.join("");a=this.uri.match(b);
this.scheme=a[2]||(a[1]?"":null);this.authority=a[4]||(a[3]?"":null);this.path=a[5];this.query=a[7]||(a[6]?"":null);this.fragment=a[9]||(a[8]?"":null);if(this.authority!=null)a=this.authority.match(c),this.user=a[3]||null,this.password=a[4]||null,this.host=a[6]||a[7],this.port=a[9]||null};dojo._Url.prototype.toString=function(){return this.uri};dojo.moduleUrl=function(a,b){var c=f._getModuleSymbols(a).join("/");if(!c)return null;c.lastIndexOf("/")!=c.length-1&&(c+="/");var g=c.indexOf(":");if(c.charAt(0)!=
"/"&&(g==-1||g>c.indexOf("/")))c=f.baseUrl+c;return new f._Url(c,b)}})();if(typeof window!="undefined"){dojo.isBrowser=!0;dojo._name="browser";(function(){var a=dojo;if(document&&document.getElementsByTagName)for(var b=document.getElementsByTagName("script"),c=/dojo(\.xd)?\.js(\W|$)/i,d=0;d<b.length;d++){var e=b[d].getAttribute("src");if(e){var k=e.match(c);if(k){if(!a.config.baseUrl)a.config.baseUrl=e.substring(0,k.index);if(b=b[d].getAttribute("djConfig")||b[d].getAttribute("data-dojo-config")){var b=
eval("({ "+b+" })"),h;for(h in b)dojo.config[h]=b[h]}break}}}a.baseUrl=a.config.baseUrl;h=navigator;b=h.userAgent;c=h.appVersion;d=parseFloat(c);if(b.indexOf("Opera")>=0)a.isOpera=d;if(b.indexOf("AdobeAIR")>=0)a.isAIR=1;a.isKhtml=c.indexOf("Konqueror")>=0?d:0;a.isWebKit=parseFloat(b.split("WebKit/")[1])||void 0;a.isChrome=parseFloat(b.split("Chrome/")[1])||void 0;a.isMac=c.indexOf("Macintosh")>=0;if((e=Math.max(c.indexOf("WebKit"),c.indexOf("Safari"),0))&&!dojo.isChrome)if(a.isSafari=parseFloat(c.split("Version/")[1]),
!a.isSafari||parseFloat(c.substr(e+7))<=419.3)a.isSafari=2;if(b.indexOf("Gecko")>=0&&!a.isKhtml&&!a.isWebKit)a.isMozilla=a.isMoz=d;if(a.isMoz)a.isFF=parseFloat(b.split("Firefox/")[1]||b.split("Minefield/")[1])||void 0;if(document.all&&!a.isOpera&&(a.isIE=parseFloat(c.split("MSIE ")[1])||void 0,(b=document.documentMode)&&b!=5&&Math.floor(a.isIE)!=b))a.isIE=b;if(dojo.isIE&&window.location.protocol==="file:")dojo.config.ieForceActiveXXhr=!0;a.isQuirks=document.compatMode=="BackCompat";a.locale=dojo.config.locale||
(a.isIE?h.userLanguage:h.language).toLowerCase();a._XMLHTTP_PROGIDS=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"];a._xhrObj=function(){var b,c;if(!dojo.isIE||!dojo.config.ieForceActiveXXhr)try{b=new XMLHttpRequest}catch(g){}if(!b)for(var p=0;p<3;++p){var n=a._XMLHTTP_PROGIDS[p];try{b=new ActiveXObject(n)}catch(i){c=i}if(b){a._XMLHTTP_PROGIDS=[n];break}}if(!b)throw Error("XMLHTTP not available: "+c);return b};a._isDocumentOk=function(a){var a=a.status||0,f=location.protocol;return a>=
200&&a<300||a==304||a==1223||!a&&(f=="file:"||f=="chrome:"||f=="chrome-extension:"||f=="app:")};var g=window.location+"",p=(h=document.getElementsByTagName("base"))&&h.length>0;a._getText=function(b,c){var n=a._xhrObj();!p&&dojo._Url&&(b=(new dojo._Url(g,b)).toString());a.config.cacheBust&&(b+="",b+=(b.indexOf("?")==-1?"?":"&")+String(a.config.cacheBust).replace(/\W+/g,""));n.open("GET",b,!1);try{if(n.send(null),!a._isDocumentOk(n)){var i=Error("Unable to load "+b+" status:"+n.status);i.status=n.status;
i.responseText=n.responseText;throw i;}}catch(d){if(c)return null;throw d;}return n.responseText};var m=window,j=function(a,f){var b=m.attachEvent||m.addEventListener,a=m.attachEvent?a:a.substring(2);b(a,function(){f.apply(m,arguments)},!1)};a._windowUnloaders=[];a.windowUnloaded=function(){for(var b=a._windowUnloaders;b.length;)b.pop()();a=null};var l=0;a.addOnWindowUnload=function(b,c){a._onto(a._windowUnloaders,b,c);l||(l=1,j("onunload",a.windowUnloaded))};var x=0;a.addOnUnload=function(b,c){a._onto(a._unloaders,
b,c);x||(x=1,j("onbeforeunload",dojo.unloaded))}})();dojo._initFired=!1;dojo._loadInit=function(){if(dojo._scrollIntervalId)clearInterval(dojo._scrollIntervalId),dojo._scrollIntervalId=0;if(!dojo._initFired)dojo._initFired=!0,!dojo.config.afterOnLoad&&window.detachEvent&&window.detachEvent("onload",dojo._loadInit),dojo._inFlightCount==0&&dojo._modulesLoaded()};if(!dojo.config.afterOnLoad)if(document.addEventListener)document.addEventListener("DOMContentLoaded",dojo._loadInit,!1),window.addEventListener("load",
dojo._loadInit,!1);else if(window.attachEvent&&(window.attachEvent("onload",dojo._loadInit),!dojo.config.skipIeDomLoaded&&self===self.top))dojo._scrollIntervalId=setInterval(function(){try{document.body&&(document.documentElement.doScroll("left"),dojo._loadInit())}catch(a){}},30);if(dojo.isIE)try{(function(){document.namespaces.add("v","urn:schemas-microsoft-com:vml");var a="*,group,roundrect,oval,shape,rect,imagedata,path,textpath,text".split(","),b=0,c=1,d=document.createStyleSheet();if(dojo.isIE>=
8)b=1,c=a.length;for(;b<c;++b)d.addRule("v\\:"+a[b],"behavior:url(#default#VML); display:inline-block")})()}catch(h){}}(function(){var a=dojo.config.modulePaths;if(a)for(var b in a)dojo.registerModulePath(b,a[b])})();dojo.config.isDebug&&dojo.require("dojo._firebug.firebug");dojo.config.debugAtAllCosts&&(dojo.require("dojo._base._loader.loader_debug"),dojo.require("dojo.i18n"));dojo._hasResource["dojo._base.lang"]||(dojo._hasResource["dojo._base.lang"]=!0,dojo.provide("dojo._base.lang"),function(){var a=
dojo,b=Object.prototype.toString;dojo.isString=function(a){return typeof a=="string"||a instanceof String};dojo.isArray=function(a){return a&&(a instanceof Array||typeof a=="array")};dojo.isFunction=function(a){return b.call(a)==="[object Function]"};dojo.isObject=function(b){return b!==void 0&&(b===null||typeof b=="object"||a.isArray(b)||a.isFunction(b))};dojo.isArrayLike=function(b){return b&&b!==void 0&&!a.isString(b)&&!a.isFunction(b)&&!(b.tagName&&b.tagName.toLowerCase()=="form")&&(a.isArray(b)||
isFinite(b.length))};dojo.isAlien=function(b){return b&&!a.isFunction(b)&&/\{\s*\[native code\]\s*\}/.test(String(b))};dojo.extend=function(b,c){for(var g=1,n=arguments.length;g<n;g++)a._mixin(b.prototype,arguments[g]);return b};dojo._hitchArgs=function(b,c){var g=a._toArray(arguments,2),n=a.isString(c);return function(){var i=a._toArray(arguments),d=n?(b||a.global)[c]:c;return d&&d.apply(b||this,g.concat(i))}};dojo.hitch=function(b,c){if(arguments.length>2)return a._hitchArgs.apply(a,arguments);
c||(c=b,b=null);if(a.isString(c)){b=b||a.global;if(!b[c])throw['dojo.hitch: scope["',c,'"] is null (scope="',b,'")'].join("");return function(){return b[c].apply(b,arguments||[])}}return!b?c:function(){return c.apply(b,arguments||[])}};dojo.delegate=dojo._delegate=function(){function b(){}return function(c,g){b.prototype=c;var n=new b;b.prototype=null;g&&a._mixin(n,g);return n}}();var c=function(a,f,b){return(b||[]).concat(Array.prototype.slice.call(a,f||0))},d=function(a,f,b){b=b||[];for(f=f||0;f<
a.length;f++)b.push(a[f]);return b};dojo._toArray=a.isIE?function(a){return(a.item?d:c).apply(this,arguments)}:c;dojo.partial=function(b){return a.hitch.apply(a,[null].concat(a._toArray(arguments)))};var e=a._extraNames,k=e.length,h={};dojo.clone=function(b){if(!b||typeof b!="object"||a.isFunction(b))return b;if(b.nodeType&&"cloneNode"in b)return b.cloneNode(!0);if(b instanceof Date)return new Date(b.getTime());if(b instanceof RegExp)return RegExp(b);var c,g,n,i;if(a.isArray(b)){c=[];for(g=0,n=b.length;g<
n;++g)g in b&&c.push(a.clone(b[g]))}else c=b.constructor?new b.constructor:{};for(i in b)if(n=b[i],!(i in c)||c[i]!==n&&(!(i in h)||h[i]!==n))c[i]=a.clone(n);if(k)for(g=0;g<k;++g)if(i=e[g],n=b[i],!(i in c)||c[i]!==n&&(!(i in h)||h[i]!==n))c[i]=n;return c};dojo.trim=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};var g=/\{([^\}]+)\}/g;dojo.replace=function(b,c,n){return b.replace(n||g,a.isFunction(c)?c:function(b,g){return a.getObject(g,
!1,c)})}}());dojo._hasResource["dojo._base.array"]||(dojo._hasResource["dojo._base.array"]=!0,dojo.provide("dojo._base.array"),function(){var a=function(a,b,f){return[typeof a=="string"?a.split(""):a,b||dojo.global,typeof f=="string"?new Function("item","index","array",f):f]},b=function(b,c,i,d){for(var i=a(c,d,i),c=i[0],d=0,e=c.length;d<e;++d){var g=!!i[2].call(i[1],c[d],d,c);if(b^g)return g}return b};dojo.mixin(dojo,{indexOf:function(a,b,f,c){var i=1,g=a.length||0,d=0;c&&(d=g-1,i=g=-1);f!=void 0&&
(d=f);if(c&&d>g||d<g)for(;d!=g;d+=i)if(a[d]==b)return d;return-1},lastIndexOf:function(a,b,f){return dojo.indexOf(a,b,f,!0)},forEach:function(b,c,i){if(b&&b.length)for(var c=a(b,i,c),b=c[0],i=0,d=b.length;i<d;++i)c[2].call(c[1],b[i],i,b)},every:function(a,f,c){return b(!0,a,f,c)},some:function(a,f,c){return b(!1,a,f,c)},map:function(b,c,i,d){for(var c=a(b,i,c),b=c[0],d=d?new d:[],i=0,e=b.length;i<e;++i)d.push(c[2].call(c[1],b[i],i,b));return d},filter:function(b,c,i){for(var c=a(b,i,c),b=c[0],i=[],
d=0,e=b.length;d<e;++d)c[2].call(c[1],b[d],d,b)&&i.push(b[d]);return i}})}());dojo._hasResource["dojo._base.declare"]||(dojo._hasResource["dojo._base.declare"]=!0,dojo.provide("dojo._base.declare"),function(){function a(b,f){throw Error("declare"+(f?" "+f:"")+": "+b);}function b(c,g,i){var d,n,e,p,h,q,k,m=this._inherited=this._inherited||{};typeof c=="string"&&(d=c,c=g,g=i);i=0;p=c.callee;(d=d||p.nom)||a("can't deduce a name to call inherited()",this.declaredClass);h=this.constructor._meta;e=h.bases;
k=m.p;if(d!=M){if(m.c!==p&&(k=0,q=e[0],h=q._meta,h.hidden[d]!==p)){(n=h.chains)&&typeof n[d]=="string"&&a("calling chained method with inherited: "+d,this.declaredClass);do if(h=q._meta,n=q.prototype,h&&(n[d]===p&&n.hasOwnProperty(d)||h.hidden[d]===p))break;while(q=e[++k]);k=q?k:-1}if(q=e[++k])if(n=q.prototype,q._meta&&n.hasOwnProperty(d))i=n[d];else{p=u[d];do if(n=q.prototype,(i=n[d])&&(q._meta?n.hasOwnProperty(d):i!==p))break;while(q=e[++k])}i=q&&i||u[d]}else{if(m.c!==p&&(k=0,(h=e[0]._meta)&&h.ctor!==
p)){n=h.chains;for((!n||n.constructor!=="manual")&&a("calling chained constructor with inherited",this.declaredClass);q=e[++k];)if((h=q._meta)&&h.ctor===p)break;k=q?k:-1}for(;q=e[++k];)if(i=(h=q._meta)?h.ctor:q)break;i=q&&i}m.c=i;m.p=k;if(i)return g===!0?i:i.apply(this,g||c)}function c(a,b){return typeof a=="string"?this.inherited(a,b,!0):this.inherited(a,!0)}function d(a){for(var b=this.constructor._meta.bases,f=0,c=b.length;f<c;++f)if(b[f]===a)return!0;return this instanceof a}function e(a,b){var f,
c=0,g=N._extraNames.length;for(f in b)f!=M&&b.hasOwnProperty(f)&&(a[f]=b[f]);for(;c<g;++c)f=N._extraNames[c],f!=M&&b.hasOwnProperty(f)&&(a[f]=b[f])}function h(a,b){var f,c,g=0,i=N._extraNames.length;for(f in b)if(c=b[f],(c!==u[f]||!(f in u))&&f!=M){if(G.call(c)=="[object Function]")c.nom=f;a[f]=c}for(;g<i;++g)if(f=N._extraNames[g],c=b[f],(c!==u[f]||!(f in u))&&f!=M){if(G.call(c)=="[object Function]")c.nom=f;a[f]=c}return a}function k(a){h(this.prototype,a);return this}function g(a,b){return function(){var o;
var f=arguments,c=f,g=f[0],i,d;d=a.length;var n;if(!(this instanceof f.callee))return x(f);if(b&&(g&&g.preamble||this.preamble)){n=Array(a.length);n[0]=f;for(i=0;;){if(g=f[0])(g=g.preamble)&&(f=g.apply(this,f)||f);g=a[i].prototype;(g=g.hasOwnProperty("preamble")&&g.preamble)&&(f=g.apply(this,f)||f);if(++i==d)break;n[i]=f}}for(i=d-1;i>=0;--i)g=a[i],(o=(d=g._meta)?d.ctor:g,g=o)&&g.apply(this,n?n[i]:f);(g=this.postscript)&&g.apply(this,c)}}function p(a,b){return function(){var f=arguments,c=f,g=f[0];
if(!(this instanceof f.callee))return x(f);if(b){if(g)(g=g.preamble)&&(c=g.apply(this,c)||c);(g=this.preamble)&&g.apply(this,c)}a&&a.apply(this,f);(g=this.postscript)&&g.apply(this,f)}}function m(a){return function(){var i;var b=arguments,f=0,c,g;if(!(this instanceof b.callee))return x(b);for(;c=a[f];++f)if(i=(g=c._meta)?g.ctor:c,c=i){c.apply(this,b);break}(c=this.postscript)&&c.apply(this,b)}}function j(a,b,f){return function(){var c,g,i=0,d=1;f&&(i=b.length-1,d=-1);for(;c=b[i];i+=d)g=c._meta,(c=
(g?g.hidden:c.prototype)[a])&&c.apply(this,arguments)}}function l(a){v.prototype=a.prototype;a=new v;v.prototype=null;return a}function x(a){var b=a.callee,f=l(b);b.apply(f,a);return f}var N=dojo,q=N._mixin,u=Object.prototype,G=u.toString,v=new Function,R=0,M="constructor";N.declare=function(x,v,H){typeof x!="string"&&(H=v,v=x,x="");var H=H||{},E,J,w,C,F,A,K,L=1,T=v;if(G.call(v)=="[object Array]"){L=x;w=[];C=[{cls:0,refs:[]}];A={};for(var U=1,V=v.length,P=0,I,Q,D,O;P<V;++P){(I=v[P])?G.call(I)!="[object Function]"&&
a("mixin #"+P+" is not a callable constructor.",L):a("mixin #"+P+" is unknown. Did you use dojo.require to pull it in?",L);Q=I._meta?I._meta.bases:[I];D=0;for(I=Q.length-1;I>=0;--I){O=Q[I].prototype;if(!O.hasOwnProperty("declaredClass"))O.declaredClass="uniqName_"+R++;O=O.declaredClass;A.hasOwnProperty(O)||(A[O]={count:0,refs:[],cls:Q[I]},++U);O=A[O];D&&D!==O&&(O.refs.push(D),++D.count);D=O}++D.count;C[0].refs.push(D)}for(;C.length;){D=C.pop();w.push(D.cls);for(--U;J=D.refs,J.length==1;){D=J[0];if(!D||
--D.count){D=0;break}w.push(D.cls);--U}if(D)for(P=0,V=J.length;P<V;++P)D=J[P],--D.count||C.push(D)}U&&a("can't build consistent linearization",L);I=v[0];w[0]=I?I._meta&&I===w[w.length-I._meta.bases.length]?I._meta.bases.length:1:0;A=w;w=A[0];L=A.length-w;v=A[L]}else A=[0],v?G.call(v)=="[object Function]"?(w=v._meta,A=A.concat(w?w.bases:v)):a("base class is not a callable constructor.",x):v!==null&&a("unknown base class. Did you use dojo.require to pull it in?",x);if(v)for(J=L-1;;--J){E=l(v);if(!J)break;
w=A[J];(w._meta?e:q)(E,w.prototype);C=new Function;C.superclass=v;C.prototype=E;v=E.constructor=C}else E={};h(E,H);w=H.constructor;if(w!==u.constructor)w.nom=M,E.constructor=w;for(J=L-1;J;--J)(w=A[J]._meta)&&w.chains&&(K=q(K||{},w.chains));E["-chains-"]&&(K=q(K||{},E["-chains-"]));w=!K||!K.hasOwnProperty(M);A[0]=C=K&&K.constructor==="manual"?m(A):A.length==1?p(H.constructor,w):g(A,w);C._meta={bases:A,hidden:H,chains:K,parents:T,ctor:H.constructor};C.superclass=v&&v.prototype;C.extend=k;C.prototype=
E;E.constructor=C;E.getInherited=c;E.inherited=b;E.isInstanceOf=d;if(x)E.declaredClass=x,N.setObject(x,C);if(K)for(F in K)if(E[F]&&typeof K[F]=="string"&&F!=M)w=E[F]=j(F,A,K[F]==="after"),w.nom=F;return C};N.safeMixin=h}());if(!dojo._hasResource["dojo._base.connect"])dojo._hasResource["dojo._base.connect"]=!0,dojo.provide("dojo._base.connect"),dojo._listener={getDispatcher:function(){return function(){var a=Array.prototype,b=arguments.callee,c=b._listeners,b=(b=b.target)&&b.apply(this,arguments),
d,c=[].concat(c);for(d in c)d in a||c[d].apply(this,arguments);return b}},add:function(a,b,c){var a=a||dojo.global,d=a[b];if(!d||!d._listeners){var e=dojo._listener.getDispatcher();e.target=d;e._listeners=[];d=a[b]=e}return d._listeners.push(c)},remove:function(a,b,c){(a=(a||dojo.global)[b])&&a._listeners&&c--&&delete a._listeners[c]}},dojo.connect=function(a,b,c,d,e){var h=arguments,k=[],g=0;k.push(dojo.isString(h[0])?null:h[g++],h[g++]);var p=h[g+1];k.push(dojo.isString(p)||dojo.isFunction(p)?h[g++]:
null,h[g++]);for(p=h.length;g<p;g++)k.push(h[g]);return dojo._connect.apply(this,k)},dojo._connect=function(a,b,c,d){var e=dojo._listener,c=e.add(a,b,dojo.hitch(c,d));return[a,b,c,e]},dojo.disconnect=function(a){a&&a[0]!==void 0&&(dojo._disconnect.apply(this,a),delete a[0])},dojo._disconnect=function(a,b,c,d){d.remove(a,b,c)},dojo._topics={},dojo.subscribe=function(a,b,c){return[a,dojo._listener.add(dojo._topics,a,dojo.hitch(b,c))]},dojo.unsubscribe=function(a){a&&dojo._listener.remove(dojo._topics,
a[0],a[1])},dojo.publish=function(a,b){var c=dojo._topics[a];c&&c.apply(this,b||[])},dojo.connectPublisher=function(a,b,c){var d=function(){dojo.publish(a,arguments)};return c?dojo.connect(b,c,d):dojo.connect(b,d)};if(!dojo._hasResource["dojo._base.Deferred"])dojo._hasResource["dojo._base.Deferred"]=!0,dojo.provide("dojo._base.Deferred"),function(){var a=function(){},b=Object.freeze||function(){};dojo.Deferred=function(c){function d(a){if(k)throw Error("This deferred has already been resolved");h=
a;k=!0;e()}function e(){for(var b;!b&&m;){var c=m;m=m.next;if(b=c.progress==a)k=!1;var d=g?c.error:c.resolved;if(d)try{var i=d(h);i&&typeof i.then==="function"?i.then(dojo.hitch(c.deferred,"resolve"),dojo.hitch(c.deferred,"reject")):(d=b&&i===void 0,b&&!d&&(g=i instanceof Error),c.deferred[d&&g?"reject":"resolve"](d?h:i))}catch(n){c.deferred.reject(n)}else g?c.deferred.reject(h):c.deferred.resolve(h)}}var h,k,g,p,m,j=this.promise={};this.resolve=this.callback=function(a){this.fired=0;this.results=
[a,null];d(a)};this.reject=this.errback=function(a){g=!0;this.fired=1;d(a);this.results=[null,a];if(!a||a.log!==!1)(dojo.config.deferredOnError||function(a){console.error(a)})(a)};this.progress=function(a){for(var b=m;b;){var f=b.progress;f&&f(a);b=b.next}};this.addCallbacks=function(b,c){this.then(b,c,a);return this};this.then=j.then=function(b,c,g){var d=g==a?this:new dojo.Deferred(j.cancel),b={resolved:b,error:c,progress:g,deferred:d};m?p=p.next=b:m=p=b;k&&e();return d.promise};var l=this;this.cancel=
j.cancel=function(){if(!k){var a=c&&c(l);if(!k)a instanceof Error||(a=Error(a)),a.log=!1,l.reject(a)}};b(j)};dojo.extend(dojo.Deferred,{addCallback:function(a){return this.addCallbacks(dojo.hitch.apply(dojo,arguments))},addErrback:function(a){return this.addCallbacks(null,dojo.hitch.apply(dojo,arguments))},addBoth:function(a){var b=dojo.hitch.apply(dojo,arguments);return this.addCallbacks(b,b)},fired:-1})}(),dojo.when=function(a,b,c,d){return a&&typeof a.then==="function"?a.then(b,c,d):b(a)};if(!dojo._hasResource["dojo._base.json"])dojo._hasResource["dojo._base.json"]=
!0,dojo.provide("dojo._base.json"),dojo.fromJson=function(a){return eval("("+a+")")},dojo._escapeString=function(a){return('"'+a.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},dojo.toJsonIndentStr="\t",dojo.toJson=function(a,b,c){if(a===void 0)return"undefined";var d=typeof a;if(d=="number"||d=="boolean")return a+"";if(a===null)return"null";if(dojo.isString(a))return dojo._escapeString(a);var e=arguments.callee,
h,c=c||"",k=b?c+dojo.toJsonIndentStr:"";h=a.__json__||a.json;if(dojo.isFunction(h)&&(h=h.call(a),a!==h))return e(h,b,k);if(a.nodeType&&a.cloneNode)throw Error("Can't serialize DOM nodes");h=b?" ":"";var g=b?"\n":"";if(dojo.isArray(a))return"["+dojo.map(a,function(a){a=e(a,b,k);typeof a!="string"&&(a="undefined");return g+k+a}).join(","+h)+g+c+"]";if(d=="function")return null;var d=[],p;for(p in a){var m,j;if(typeof p=="number")m='"'+p+'"';else if(typeof p=="string")m=dojo._escapeString(p);else continue;
j=e(a[p],b,k);typeof j=="string"&&d.push(g+k+m+":"+h+j)}return"{"+d.join(","+h)+g+c+"}"};dojo._hasResource["dojo._base.Color"]||(dojo._hasResource["dojo._base.Color"]=!0,dojo.provide("dojo._base.Color"),function(){var a=dojo;dojo.Color=function(a){a&&this.setColor(a)};dojo.Color.named={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,
0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],transparent:a.config.transparentColor||[255,255,255]};dojo.extend(dojo.Color,{r:255,g:255,b:255,a:1,_set:function(a,b,f,c){this.r=a;this.g=b;this.b=f;this.a=c},setColor:function(b){a.isString(b)?a.colorFromString(b,this):a.isArray(b)?a.colorFromArray(b,this):(this._set(b.r,b.g,b.b,b.a),b instanceof a.Color||this.sanitize());return this},sanitize:function(){return this},toRgb:function(){return[this.r,this.g,this.b]},toRgba:function(){return[this.r,
this.g,this.b,this.a]},toHex:function(){return"#"+a.map(["r","g","b"],function(a){a=this[a].toString(16);return a.length<2?"0"+a:a},this).join("")},toCss:function(a){var b=this.r+", "+this.g+", "+this.b;return(a?"rgba("+b+", "+this.a:"rgb("+b)+")"},toString:function(){return this.toCss(!0)}});dojo.blendColors=function(b,c,d,h){var e=h||new a.Color;a.forEach(["r","g","b","a"],function(a){e[a]=b[a]+(c[a]-b[a])*d;a!="a"&&(e[a]=Math.round(e[a]))});return e.sanitize()};dojo.colorFromRgb=function(a,b){var f=
a.toLowerCase().match(/^rgba?\(([\s\.,0-9]+)\)/);return f&&dojo.colorFromArray(f[1].split(/\s*,\s*/),b)};dojo.colorFromHex=function(b,c){var d=c||new a.Color,e=b.length==4?4:8,h=(1<<e)-1,b=Number("0x"+b.substr(1));if(isNaN(b))return null;a.forEach(["b","g","r"],function(a){var f=b&h;b>>=e;d[a]=e==4?17*f:f});d.a=1;return d};dojo.colorFromArray=function(b,c){var d=c||new a.Color;d._set(Number(b[0]),Number(b[1]),Number(b[2]),Number(b[3]));if(isNaN(d.a))d.a=1;return d.sanitize()};dojo.colorFromString=
function(b,c){var d=a.Color.named[b];return d&&a.colorFromArray(d,c)||a.colorFromRgb(b,c)||a.colorFromHex(b,c)}}());if(!dojo._hasResource["dojo._base.window"])dojo._hasResource["dojo._base.window"]=!0,dojo.provide("dojo._base.window"),dojo.doc=window.document||null,dojo.body=function(){return dojo.doc.body||dojo.doc.getElementsByTagName("body")[0]},dojo.setContext=function(a,b){dojo.global=a;dojo.doc=b},dojo.withGlobal=function(a,b,c,d){var e=dojo.global;try{return dojo.global=a,dojo.withDoc.call(null,
a.document,b,c,d)}finally{dojo.global=e}},dojo.withDoc=function(a,b,c,d){var e=dojo.doc,h=dojo._bodyLtr,k=dojo.isQuirks;try{return dojo.doc=a,delete dojo._bodyLtr,dojo.isQuirks=dojo.doc.compatMode=="BackCompat",c&&typeof b=="string"&&(b=c[b]),b.apply(c,d||[])}finally{dojo.doc=e;delete dojo._bodyLtr;if(h!==void 0)dojo._bodyLtr=h;dojo.isQuirks=k}};if(!dojo._hasResource["dojo._base.event"]&&(dojo._hasResource["dojo._base.event"]=!0,dojo.provide("dojo._base.event"),function(){var a=dojo._event_listener=
{add:function(b,c,d){if(b){c=a._normalizeEventName(c);d=a._fixCallback(c,d);if(!dojo.isIE&&(c=="mouseenter"||c=="mouseleave"))var e=d,c=c=="mouseenter"?"mouseover":"mouseout",d=function(a){if(!dojo.isDescendant(a.relatedTarget,b))return e.call(this,a)};b.addEventListener(c,d,!1);return d}},remove:function(b,c,d){if(b){c=a._normalizeEventName(c);if(!dojo.isIE&&(c=="mouseenter"||c=="mouseleave"))c=c=="mouseenter"?"mouseover":"mouseout";b.removeEventListener(c,d,!1)}},_normalizeEventName:function(a){return a.slice(0,
2)=="on"?a.slice(2):a},_fixCallback:function(b,c){return b!="keypress"?c:function(b){return c.call(this,a._fixEvent(b,this))}},_fixEvent:function(b){switch(b.type){case "keypress":a._setKeyChar(b)}return b},_setKeyChar:function(a){a.keyChar=a.charCode>=32?String.fromCharCode(a.charCode):"";a.charOrCode=a.keyChar||a.keyCode},_punctMap:{106:42,111:47,186:59,187:43,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39}};dojo.fixEvent=function(b,c){return a._fixEvent(b,c)};dojo.stopEvent=function(a){a.preventDefault();
a.stopPropagation()};var b=dojo._listener;dojo._connect=function(c,d,e,h,k){k=c&&(c.nodeType||c.attachEvent||c.addEventListener)?k?2:1:0;e=[dojo._listener,a,b][k].add(c,d,dojo.hitch(e,h));return[c,d,e,k]};dojo._disconnect=function(c,d,e,h){[dojo._listener,a,b][h].remove(c,d,e)};dojo.keys={BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:dojo.isSafari?91:224,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,
INSERT:45,DELETE:46,HELP:47,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_PLUS:107,NUMPAD_ENTER:108,NUMPAD_MINUS:109,NUMPAD_PERIOD:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,NUM_LOCK:144,SCROLL_LOCK:145,copyKey:dojo.isMac&&!dojo.isAIR?dojo.isSafari?91:224:17};var c=
dojo.isMac?"metaKey":"ctrlKey";dojo.isCopyKey=function(a){return a[c]};dojo.mouseButtons=dojo.isIE<9||dojo.isIE&&dojo.isQuirks?{LEFT:1,MIDDLE:4,RIGHT:2,isButton:function(a,b){return a.button&b},isLeft:function(a){return a.button&1},isMiddle:function(a){return a.button&4},isRight:function(a){return a.button&2}}:{LEFT:0,MIDDLE:1,RIGHT:2,isButton:function(a,b){return a.button==b},isLeft:function(a){return a.button==0},isMiddle:function(a){return a.button==1},isRight:function(a){return a.button==2}};
if(dojo.isIE){var d=function(a,b){try{return a.keyCode=b}catch(c){return 0}},e=dojo._listener,h=dojo._ieListenersName="_"+dojo._scopeName+"_listeners";if(!dojo.config._allow_leaks)var b=e=dojo._ie_listener={handlers:[],add:function(a,b,c){var a=a||dojo.global,f=a[b];if(!f||!f[h]){var d=dojo._getIeDispatcher();d.target=f&&k.push(f)-1;d[h]=[];f=a[b]=d}return f[h].push(k.push(c)-1)},remove:function(a,b,c){var f;f=(a=(a||dojo.global)[b])&&a[h],b=f;a&&b&&c--&&(delete k[b[c]],delete b[c])}},k=e.handlers;
dojo.mixin(a,{add:function(b,c,d){if(b){c=a._normalizeEventName(c);if(c=="onkeypress"){var i=b.onkeydown;if(!i||!i[h]||!i._stealthKeydownHandle){var k=a.add(b,"onkeydown",a._stealthKeyDown),i=b.onkeydown;i._stealthKeydownHandle=k;i._stealthKeydownRefs=1}else i._stealthKeydownRefs++}return e.add(b,c,a._fixCallback(d))}},remove:function(b,c,d){c=a._normalizeEventName(c);e.remove(b,c,d);if(c=="onkeypress")c=b.onkeydown,--c._stealthKeydownRefs<=0&&(e.remove(b,"onkeydown",c._stealthKeydownHandle),delete c._stealthKeydownHandle)},
_normalizeEventName:function(a){return a.slice(0,2)!="on"?"on"+a:a},_nop:function(){},_fixEvent:function(b,c){if(!b)b=(c&&(c.ownerDocument||c.document||c).parentWindow||window).event;if(!b)return b;b.target=b.srcElement;b.currentTarget=c||b.srcElement;b.layerX=b.offsetX;b.layerY=b.offsetY;var d=b.srcElement,d=d&&d.ownerDocument||document,d=dojo.isIE<6||d.compatMode=="BackCompat"?d.body:d.documentElement,e=dojo._getIeDocumentElementOffset();b.pageX=b.clientX+dojo._fixIeBiDiScrollLeft(d.scrollLeft||
0)-e.x;b.pageY=b.clientY+(d.scrollTop||0)-e.y;if(b.type=="mouseover")b.relatedTarget=b.fromElement;if(b.type=="mouseout")b.relatedTarget=b.toElement;if(dojo.isIE<9||dojo.isQuirks)b.stopPropagation=a._stopPropagation,b.preventDefault=a._preventDefault;return a._fixKeys(b)},_fixKeys:function(b){switch(b.type){case "keypress":var c="charCode"in b?b.charCode:b.keyCode;c==10?(c=0,b.keyCode=13):c==13||c==27?c=0:c==3&&(c=99);b.charCode=c;a._setKeyChar(b)}return b},_stealthKeyDown:function(b){var c=b.currentTarget.onkeypress;
if(c&&c[h]){var e=b.keyCode,i=(e!=13||dojo.isIE>=9&&!dojo.isQuirks)&&e!=32&&e!=27&&(e<48||e>90)&&(e<96||e>111)&&(e<186||e>192)&&(e<219||e>222);if(i||b.ctrlKey){i=i?0:e;if(b.ctrlKey)if(e==3||e==13)return;else i>95&&i<106?i-=48:!b.shiftKey&&i>=65&&i<=90?i+=32:i=a._punctMap[i]||i;e=a._synthesizeEvent(b,{type:"keypress",faux:!0,charCode:i});c.call(b.currentTarget,e);if(dojo.isIE<9||dojo.isIE&&dojo.isQuirks)b.cancelBubble=e.cancelBubble;b.returnValue=e.returnValue;d(b,e.keyCode)}}},_stopPropagation:function(){this.cancelBubble=
!0},_preventDefault:function(){this.bubbledKeyCode=this.keyCode;this.ctrlKey&&d(this,0);this.returnValue=!1}});dojo.stopEvent=dojo.isIE<9||dojo.isQuirks?function(b){b=b||window.event;a._stopPropagation.call(b);a._preventDefault.call(b)}:dojo.stopEvent}a._synthesizeEvent=function(b,c){var d=dojo.mixin({},b,c);a._setKeyChar(d);d.preventDefault=function(){b.preventDefault()};d.stopPropagation=function(){b.stopPropagation()};return d};dojo.isOpera&&dojo.mixin(a,{_fixEvent:function(b){switch(b.type){case "keypress":var c=
b.which;c==3&&(c=99);c=c<41&&!b.shiftKey?0:c;b.ctrlKey&&!b.shiftKey&&c>=65&&c<=90&&(c+=32);return a._synthesizeEvent(b,{charCode:c})}return b}});if(dojo.isWebKit)a._add=a.add,a._remove=a.remove,dojo.mixin(a,{add:function(b,c,d){if(b){var e=a._add(b,c,d);if(a._normalizeEventName(c)=="keypress")e._stealthKeyDownHandle=a._add(b,"keydown",function(b){var c=b.keyCode,e=c!=13&&c!=32&&(c<48||c>90)&&(c<96||c>111)&&(c<186||c>192)&&(c<219||c>222);if(e||b.ctrlKey){e=e?0:c;if(b.ctrlKey)if(c==3||c==13)return;
else e>95&&e<106?e-=48:!b.shiftKey&&e>=65&&e<=90?e+=32:e=a._punctMap[e]||e;c=a._synthesizeEvent(b,{type:"keypress",faux:!0,charCode:e});d.call(b.currentTarget,c)}});return e}},remove:function(b,c,d){b&&(d._stealthKeyDownHandle&&a._remove(b,"keydown",d._stealthKeyDownHandle),a._remove(b,c,d))},_fixEvent:function(b){switch(b.type){case "keypress":if(b.faux)break;var c=b.charCode;return a._synthesizeEvent(b,{charCode:c>=32?c:0,faux:!0})}return b}})}(),dojo.isIE))dojo._ieDispatcher=function(a,b){var c=
Array.prototype,d=dojo._ie_listener.handlers,e=a.callee,h=e[dojo._ieListenersName],e=(e=d[e.target])&&e.apply(b,a),h=[].concat(h),k;for(k in h){var g=d[h[k]];!(k in c)&&g&&g.apply(b,a)}return e},dojo._getIeDispatcher=function(){return new Function(dojo._scopeName+"._ieDispatcher(arguments, this)")},dojo._event_listener._fixCallback=function(a){var b=dojo._event_listener._fixEvent;return function(c){return a.call(this,b(c,this))}};if(!dojo._hasResource["dojo._base.html"]){dojo._hasResource["dojo._base.html"]=
!0;dojo.provide("dojo._base.html");try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){}dojo.byId=dojo.isIE?function(a,b){if(typeof a!="string")return a;var c=b||dojo.doc,d=c.getElementById(a);if(d&&(d.attributes.id.value==a||d.id==a))return d;else{c=c.all[a];if(!c||c.nodeName)c=[c];for(var e=0;d=c[e++];)if(d.attributes&&d.attributes.id&&d.attributes.id.value==a||d.id==a)return d}}:function(a,b){return(typeof a=="string"?(b||dojo.doc).getElementById(a):a)||null};(function(){var a=dojo,
b=a.byId,c=null,d;a.addOnWindowUnload(function(){c=null});dojo._destroyElement=dojo.destroy=function(a){a=b(a);try{var f=a.ownerDocument;if(!c||d!=f)c=f.createElement("div"),d=f;c.appendChild(a.parentNode?a.parentNode.removeChild(a):a);c.innerHTML=""}catch(e){}};dojo.isDescendant=function(a,c){try{a=b(a);for(c=b(c);a;){if(a==c)return!0;a=a.parentNode}}catch(f){}return!1};dojo.setSelectable=function(c,d){c=b(c);if(a.isMozilla)c.style.MozUserSelect=d?"":"none";else if(a.isKhtml||a.isWebKit)c.style.KhtmlUserSelect=
d?"auto":"none";else if(a.isIE){var e=c.unselectable=d?"":"on";a.query("*",c).forEach("item.unselectable = '"+e+"'")}};var e=function(a,b){var c=b.parentNode;c&&c.insertBefore(a,b)};dojo.place=function(c,d,h){d=b(d);typeof c=="string"&&(c=/^\s*</.test(c)?a._toDom(c,d.ownerDocument):b(c));if(typeof h=="number"){var g=d.childNodes;!g.length||g.length<=h?d.appendChild(c):e(c,g[h<0?0:h])}else switch(h){case "before":e(c,d);break;case "after":h=c;(g=d.parentNode)&&(g.lastChild==d?g.appendChild(h):g.insertBefore(h,
d.nextSibling));break;case "replace":d.parentNode.replaceChild(c,d);break;case "only":a.empty(d);d.appendChild(c);break;case "first":if(d.firstChild){e(c,d.firstChild);break}default:d.appendChild(c)}return c};dojo.boxModel="content-box";if(a.isIE)a.boxModel=document.compatMode=="BackCompat"?"border-box":"content-box";var h;h=a.isWebKit?function(a){var b;if(a.nodeType==1){var c=a.ownerDocument.defaultView;b=c.getComputedStyle(a,null);if(!b&&a.style)a.style.display="",b=c.getComputedStyle(a,null)}return b||
{}}:a.isIE?function(a){return a.nodeType==1?a.currentStyle:{}}:function(a){return a.nodeType==1?a.ownerDocument.defaultView.getComputedStyle(a,null):{}};dojo.getComputedStyle=h;a._toPixelValue=a.isIE?function(a,b){if(!b)return 0;if(b=="medium")return 4;if(b.slice&&b.slice(-2)=="px")return parseFloat(b);with(a){var c=style.left,f=runtimeStyle.left;runtimeStyle.left=currentStyle.left;try{style.left=b,b=style.pixelLeft}catch(d){b=0}style.left=c;runtimeStyle.left=f}return b}:function(a,b){return parseFloat(b)||
0};var k=a._toPixelValue,g=function(a,b){try{return a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(c){return b?{}:null}};dojo._getOpacity=a.isIE<9?function(a){try{return g(a).Opacity/100}catch(b){return 1}}:function(a){return h(a).opacity};dojo._setOpacity=a.isIE<9?function(b,c){var d=c*100,e=c==1;b.style.zoom=e?"":1;if(g(b))g(b,1).Opacity=d;else{if(e)return c;b.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(Opacity="+d+")"}g(b,1).Enabled=!e;b.nodeName.toLowerCase()=="tr"&&a.query("> td",
b).forEach(function(b){a._setOpacity(b,c)});return c}:function(a,b){return a.style.opacity=b};var m={left:!0,top:!0},j=/margin|padding|width|height|max|min|offset/,l=function(b,c,d){c=c.toLowerCase();if(a.isIE){if(d=="auto"){if(c=="height")return b.offsetHeight;if(c=="width")return b.offsetWidth}if(c=="fontweight")switch(d){case 700:return"bold";default:return"normal"}}c in m||(m[c]=j.test(c));return m[c]?k(b,d):d},y=a.isIE?"styleFloat":"cssFloat",x={cssFloat:y,styleFloat:y,"float":y};dojo.style=
function(c,d,e){var g=b(c),k=arguments.length,q=d=="opacity",d=x[d]||d;if(k==3)return q?a._setOpacity(g,e):g.style[d]=e;if(k==2&&q)return a._getOpacity(g);q=h(g);if(k==2&&typeof d!="string"){for(var n in d)a.style(c,n,d[n]);return q}return k==1?q:l(g,d,q[d]||g.style[d])};dojo._getPadExtents=function(a,b){var c=b||h(a),f=k(a,c.paddingLeft),d=k(a,c.paddingTop);return{l:f,t:d,w:f+k(a,c.paddingRight),h:d+k(a,c.paddingBottom)}};dojo._getBorderExtents=function(a,b){var c=b||h(a),f=c.borderLeftStyle!="none"?
k(a,c.borderLeftWidth):0,d=c.borderTopStyle!="none"?k(a,c.borderTopWidth):0;return{l:f,t:d,w:f+(c.borderRightStyle!="none"?k(a,c.borderRightWidth):0),h:d+(c.borderBottomStyle!="none"?k(a,c.borderBottomWidth):0)}};dojo._getPadBorderExtents=function(b,c){var d=c||h(b),e=a._getPadExtents(b,d),d=a._getBorderExtents(b,d);return{l:e.l+d.l,t:e.t+d.t,w:e.w+d.w,h:e.h+d.h}};dojo._getMarginExtents=function(b,c){var d=c||h(b),e=k(b,d.marginLeft),g=k(b,d.marginTop),i=k(b,d.marginRight),q=k(b,d.marginBottom);a.isWebKit&&
d.position!="absolute"&&(i=e);return{l:e,t:g,w:e+i,h:g+q}};dojo._getMarginBox=function(b,c){var d=c||h(b),e=a._getMarginExtents(b,d),g=b.offsetLeft-e.l,k=b.offsetTop-e.t,i=b.parentNode;if(a.isMoz){var q=parseFloat(d.left),d=parseFloat(d.top);!isNaN(q)&&!isNaN(d)?(g=q,k=d):i&&i.style&&(q=h(i),q.overflow!="visible"&&(i=a._getBorderExtents(i,q),g+=i.l,k+=i.t))}else if((a.isOpera||a.isIE>7&&!a.isQuirks)&&i)i=a._getBorderExtents(i),g-=i.l,k-=i.t;return{l:g,t:k,w:b.offsetWidth+e.w,h:b.offsetHeight+e.h}};
dojo._getMarginSize=function(c,d){var c=b(c),e=a._getMarginExtents(c,d||h(c)),g=c.getBoundingClientRect();return{w:g.right-g.left+e.w,h:g.bottom-g.top+e.h}};dojo._getContentBox=function(b,c){var d=c||h(b),e=a._getPadExtents(b,d),d=a._getBorderExtents(b,d),g=b.clientWidth,k;g?(k=b.clientHeight,d.w=d.h=0):(g=b.offsetWidth,k=b.offsetHeight);a.isOpera&&(e.l+=d.l,e.t+=d.t);return{l:e.l,t:e.t,w:g-e.w-d.w,h:k-e.h-d.h}};dojo._getBorderBox=function(b,c){var d=c||h(b),e=a._getPadExtents(b,d),d=a._getContentBox(b,
d);return{l:d.l-e.l,t:d.t-e.t,w:d.w+e.w,h:d.h+e.h}};dojo._setBox=function(a,b,c,d,f,e){e=e||"px";a=a.style;if(!isNaN(b))a.left=b+e;if(!isNaN(c))a.top=c+e;if(d>=0)a.width=d+e;if(f>=0)a.height=f+e};dojo._isButtonTag=function(a){return a.tagName=="BUTTON"||a.tagName=="INPUT"&&(a.getAttribute("type")||"").toUpperCase()=="BUTTON"};dojo._usesBorderBox=function(b){var c=b.tagName;return a.boxModel=="border-box"||c=="TABLE"||a._isButtonTag(b)};dojo._setContentSize=function(b,c,d,e){a._usesBorderBox(b)&&(e=
a._getPadBorderExtents(b,e),c>=0&&(c+=e.w),d>=0&&(d+=e.h));a._setBox(b,NaN,NaN,c,d)};dojo._setMarginBox=function(b,c,d,e,g,k){var i=k||h(b),k=a._usesBorderBox(b)?N:a._getPadBorderExtents(b,i);if(a.isWebKit&&a._isButtonTag(b)){var q=b.style;if(e>=0&&!q.width)q.width="4px";if(g>=0&&!q.height)q.height="4px"}i=a._getMarginExtents(b,i);e>=0&&(e=Math.max(e-k.w-i.w,0));g>=0&&(g=Math.max(g-k.h-i.h,0));a._setBox(b,c,d,e,g)};var N={l:0,t:0,w:0,h:0};dojo.marginBox=function(c,d){var e=b(c),g=h(e);return!d?a._getMarginBox(e,
g):a._setMarginBox(e,d.l,d.t,d.w,d.h,g)};dojo.contentBox=function(c,d){var e=b(c),g=h(e);return!d?a._getContentBox(e,g):a._setContentSize(e,d.w,d.h,g)};dojo._docScroll=function(){var b=a.global;return"pageXOffset"in b?{x:b.pageXOffset,y:b.pageYOffset}:(b=a.isQuirks?a.doc.body:a.doc.documentElement,{x:a._fixIeBiDiScrollLeft(b.scrollLeft||0),y:b.scrollTop||0})};dojo._isBodyLtr=function(){return"_bodyLtr"in a?a._bodyLtr:a._bodyLtr=(a.body().dir||a.doc.documentElement.dir||"ltr").toLowerCase()=="ltr"};
dojo._getIeDocumentElementOffset=function(){var b=a.doc.documentElement;if(a.isIE<8){var c=b.getBoundingClientRect(),d=c.left,c=c.top;a.isIE<7&&(d+=b.clientLeft,c+=b.clientTop);return{x:d<0?0:d,y:c<0?0:c}}else return{x:0,y:0}};dojo._fixIeBiDiScrollLeft=function(b){var c=a.isIE;if(c&&!a._isBodyLtr()){var d=a.isQuirks,e=d?a.doc.body:a.doc.documentElement;c==6&&!d&&a.global.frameElement&&e.scrollHeight>e.clientHeight&&(b+=e.clientLeft);return c<8||d?b+e.clientWidth-e.scrollWidth:-b}return b};dojo._abs=
dojo.position=function(c,d){var c=b(c),e=a.body(),g=e.parentNode,q=c.getBoundingClientRect(),q={x:q.left,y:q.top,w:q.right-q.left,h:q.bottom-q.top};a.isIE?(g=a._getIeDocumentElementOffset(),q.x-=g.x+(a.isQuirks?e.clientLeft+e.offsetLeft:0),q.y-=g.y+(a.isQuirks?e.clientTop+e.offsetTop:0)):a.isFF==3&&(e=h(g),q.x-=k(g,e.marginLeft)+k(g,e.borderLeftWidth),q.y-=k(g,e.marginTop)+k(g,e.borderTopWidth));d&&(e=a._docScroll(),q.x+=e.x,q.y+=e.y);return q};dojo.coords=function(c,d){var e=b(c),g=h(e),g=a._getMarginBox(e,
g),e=a.position(e,d);g.x=e.x;g.y=e.y;return g};var q={"class":"className","for":"htmlFor",tabindex:"tabIndex",readonly:"readOnly",colspan:"colSpan",frameborder:"frameBorder",rowspan:"rowSpan",valuetype:"valueType"},u={classname:"class",htmlfor:"for",tabindex:"tabIndex",readonly:"readOnly"},G={innerHTML:1,className:1,htmlFor:a.isIE,value:1},v=function(a,b){var c=a.getAttributeNode&&a.getAttributeNode(b);return c&&c.specified};dojo.hasAttr=function(a,c){var d=c.toLowerCase();return G[q[d]||c]||v(b(a),
u[d]||c)};var R={},M=0,X=dojo._scopeName+"attrid",Y={col:1,colgroup:1,table:1,tbody:1,tfoot:1,thead:1,tr:1,title:1};dojo.attr=function(c,d,e){var c=b(c),g=arguments.length;if(g==2&&typeof d!="string"){for(var h in d)a.attr(c,h,d[h]);return c}var k=d.toLowerCase();h=q[k]||d;var n=G[h],k=u[k]||d;if(g==3){if(h=="style"&&typeof e!="string")a.style(c,e);else if(h=="innerHTML")a.isIE&&c.tagName.toLowerCase()in Y?(a.empty(c),c.appendChild(a._toDom(e,c.ownerDocument))):c[h]=e;else if(a.isFunction(e)){g=a.attr(c,
X);g||(g=M++,a.attr(c,X,g));R[g]||(R[g]={});if(n=R[g][h])a.disconnect(n);else try{delete c[h]}catch(m){}R[g][h]=a.connect(c,h,e)}else n||typeof e=="boolean"?c[h]=e:c.setAttribute(k,e);return c}e=c[h];return n&&typeof e!="undefined"?e:h!="href"&&(typeof e=="boolean"||a.isFunction(e))?e:v(c,k)?c.getAttribute(k):null};dojo.removeAttr=function(a,c){b(a).removeAttribute(u[c.toLowerCase()]||c)};dojo.getNodeProp=function(a,c){var a=b(a),d=c.toLowerCase(),f=q[d]||c;if(f in a&&f!="href")return a[f];d=u[d]||
c;return v(a,d)?a.getAttribute(d):null};dojo.create=function(c,d,e,g){var h=a.doc;if(e)e=b(e),h=e.ownerDocument;typeof c=="string"&&(c=h.createElement(c));d&&a.attr(c,d);e&&a.place(c,e,g);return c};a.empty=a.isIE?function(c){for(var c=b(c),d;d=c.lastChild;)a.destroy(d)}:function(a){b(a).innerHTML=""};var H={option:["select"],tbody:["table"],thead:["table"],tfoot:["table"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","thead","tr"],legend:["fieldset"],caption:["table"],colgroup:["table"],
col:["table","colgroup"],li:["ul"]},E=/<\s*([\w\:]+)/,J={},w=0,C="__"+a._scopeName+"ToDomId",F;for(F in H)if(H.hasOwnProperty(F))y=H[F],y.pre=F=="option"?'<select multiple="multiple">':"<"+y.join("><")+">",y.post="</"+y.reverse().join("></")+">";a._toDom=function(b,c){var c=c||a.doc,d=c[C];d||(c[C]=d=++w+"",J[d]=c.createElement("div"));b+="";var e=b.match(E),g=e?e[1].toLowerCase():"",d=J[d];if(e&&H[g]){e=H[g];d.innerHTML=e.pre+b+e.post;for(e=e.length;e;--e)d=d.firstChild}else d.innerHTML=b;if(d.childNodes.length==
1)return d.removeChild(d.firstChild);for(g=c.createDocumentFragment();e=d.firstChild;)g.appendChild(e);return g};dojo.hasClass=function(a,c){return(" "+b(a).className+" ").indexOf(" "+c+" ")>=0};var A=/\s+/,K=[""],L={},T=function(a){return typeof a=="string"||a instanceof String?a.indexOf(" ")<0?(K[0]=a,K):a.split(A):a||""};dojo.addClass=function(a,c){var a=b(a),c=T(c),d=a.className,f,d=d?" "+d+" ":" ";f=d.length;for(var e=0,g=c.length,h;e<g;++e)(h=c[e])&&d.indexOf(" "+h+" ")<0&&(d+=h+" ");f<d.length&&
(a.className=d.substr(1,d.length-2))};dojo.removeClass=function(c,d){var c=b(c),e;if(d!==void 0){d=T(d);e=" "+c.className+" ";for(var g=0,h=d.length;g<h;++g)e=e.replace(" "+d[g]+" "," ");e=a.trim(e)}else e="";c.className!=e&&(c.className=e)};dojo.replaceClass=function(a,c,d){a=b(a);L.className=a.className;dojo.removeClass(L,d);dojo.addClass(L,c);if(a.className!==L.className)a.className=L.className};dojo.toggleClass=function(b,c,d){d===void 0&&(d=!a.hasClass(b,c));a[d?"addClass":"removeClass"](b,c)}})()}dojo._hasResource["dojo._base.NodeList"]||
(dojo._hasResource["dojo._base.NodeList"]=!0,dojo.provide("dojo._base.NodeList"),function(){var a=dojo,b=Array.prototype,c=b.slice,d=b.concat,e=function(b,d,e){b.sort||(b=c.call(b,0));e=e||this._NodeListCtor||a._NodeListCtor;b.constructor=e;dojo._mixin(b,e.prototype);b._NodeListCtor=e;return d?b._stash(d):b},h=function(b,d,e){d=[0].concat(c.call(d,0));e=e||a.global;return function(a){d[0]=a;return b.apply(e,d)}},k=function(a,b){return function(){this.forEach(h(a,arguments,b));return this}},g=function(a,
b){return function(){return this.map(h(a,arguments,b))}},m=function(b,c,d){return function(){var e=arguments,g=h(b,e,d);if(c.call(d||a.global,e))return this.map(g);this.forEach(g);return this}},j=function(a){return a.length==1&&typeof a[0]=="string"},l=function(a){var b=a.parentNode;b&&b.removeChild(a)};dojo.NodeList=function(){return e(Array.apply(null,arguments))};var y=a._NodeListCtor=a.NodeList,x=y.prototype;y._wrap=x._wrap=e;y._adaptAsMap=g;y._adaptAsForEach=k;y._adaptAsFilter=function(a,b){return function(){return this.filter(h(a,
arguments,b))}};y._adaptWithCondition=m;a.forEach(["slice","splice"],function(a){var c=b[a];x[a]=function(){return this._wrap(c.apply(this,arguments),a=="slice"?this:null)}});a.forEach(["indexOf","lastIndexOf","every","some"],function(b){var d=a[b];x[b]=function(){return d.apply(a,[this].concat(c.call(arguments,0)))}});a.forEach(["attr","style"],function(b){x[b]=m(a[b],j)});a.forEach("connect,addClass,removeClass,replaceClass,toggleClass,empty,removeAttr".split(","),function(b){x[b]=k(a[b])});dojo.extend(dojo.NodeList,
{_normalize:function(a,b){var c=a.parse===!0?!0:!1;if(typeof a.template=="string")var d=a.templateFunc||dojo.string&&dojo.string.substitute,a=d?d(a.template,a):a;d=typeof a;d=="string"||d=="number"?(a=dojo._toDom(a,b&&b.ownerDocument),a=a.nodeType==11?dojo._toArray(a.childNodes):[a]):dojo.isArrayLike(a)?dojo.isArray(a)||(a=dojo._toArray(a)):a=[a];if(c)a._runParse=!0;return a},_cloneNode:function(a){return a.cloneNode(!0)},_place:function(a,b,c,d){if(!(b.nodeType!=1&&c=="only"))for(var e,f=a.length,
g=f-1;g>=0;g--){var h=d?this._cloneNode(a[g]):a[g];if(a._runParse&&dojo.parser&&dojo.parser.parse){e||(e=b.ownerDocument.createElement("div"));e.appendChild(h);dojo.parser.parse(e);for(h=e.firstChild;e.firstChild;)e.removeChild(e.firstChild)}g==f-1?dojo.place(h,b,c):b.parentNode.insertBefore(h,b);b=h}},_stash:function(a){this._parent=a;return this},end:function(){return this._parent?this._parent:new this._NodeListCtor},concat:function(b){var e=a.isArray(this)?this:c.call(this,0),g=a.map(arguments,
function(b){return b&&!a.isArray(b)&&(typeof NodeList!="undefined"&&b.constructor===NodeList||b.constructor===this._NodeListCtor)?c.call(b,0):b});return this._wrap(d.apply(e,g),this)},map:function(b,c){return this._wrap(a.map(this,b,c),this)},forEach:function(b,c){a.forEach(this,b,c);return this},coords:g(a.coords),position:g(a.position),place:function(b,c){var d=a.query(b)[0];return this.forEach(function(b){a.place(b,d,c)})},orphan:function(b){return(b?a._filterQueryResult(this,b):this).forEach(l)},
adopt:function(b,c){return a.query(b).place(this[0],c)._stash(this)},query:function(b){if(!b)return this;var c=this.map(function(c){return a.query(b,c).filter(function(a){return a!==void 0})});return this._wrap(d.apply([],c),this)},filter:function(b){var c=arguments,d=this,e=0;if(typeof b=="string"){d=a._filterQueryResult(this,c[0]);if(c.length==1)return d._stash(this);e=1}return this._wrap(a.filter(d,c[e],c[e+1]),this)},addContent:function(a,b){for(var a=this._normalize(a,this[0]),c=0,d;d=this[c];c++)this._place(a,
d,b,c>0);return this},instantiate:function(b,c){var d=a.isFunction(b)?b:a.getObject(b),c=c||{};return this.forEach(function(a){new d(c,a)})},at:function(){var b=new this._NodeListCtor;a.forEach(arguments,function(a){a<0&&(a=this.length+a);this[a]&&b.push(this[a])},this);return b._stash(this)}});y.events="blur,focus,change,click,error,keydown,keypress,keyup,load,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,submit".split(",");a.forEach(y.events,function(a){var b="on"+a;x[b]=
function(a,c){return this.connect(b,a,c)}})}());dojo._hasResource["dojo._base.query"]||(dojo._hasResource["dojo._base.query"]=!0,function(){var a=function(a){var b=a.trim,c=a.forEach,d=a._NodeListCtor=a.NodeList,e=(a.isWebKit||a.isMozilla)&&a.doc.compatMode=="BackCompat",f=a.doc.firstChild.children?"children":"childNodes",h=!1,k=function(){return!0},i=function(a){a+=">~+".indexOf(a.slice(-1))>=0?" * ":" ";for(var c=function(c,d){return b(a.slice(c,d))},d=[],e=-1,f=-1,g=-1,k=-1,i=-1,m=-1,j=-1,l="",
q="",n,u=0,v=a.length,o=null,r=null,G=function(){if(m>=0)o.id=c(m,u).replace(/\\/g,""),m=-1;if(j>=0){var a=j==u?null:c(j,u);o[">~+".indexOf(a)<0?"tag":"oper"]=a;j=-1}i>=0&&(o.classes.push(c(i+1,u).replace(/\\/g,"")),i=-1)};l=q,q=a.charAt(u),u<v;u++)if(l!="\\")if(o||(n=u,o={query:null,pseudos:[],attrs:[],classes:[],tag:null,oper:null,id:null,getTag:function(){return h?this.otag:this.tag}},j=u),e>=0)if(q=="]"){r.attr?r.matchFor=c(g||e+1,u):r.attr=c(e+1,u);if((e=r.matchFor)&&(e.charAt(0)=='"'||e.charAt(0)==
"'"))r.matchFor=e.slice(1,-1);o.attrs.push(r);r=null;e=g=-1}else{if(q=="=")g="|~^$*".indexOf(l)>=0?l:"",r.type=g+q,r.attr=c(e+1,u-g.length),g=u+1}else if(f>=0){if(q==")"){if(k>=0)r.value=c(f+1,u);k=f=-1}}else if(q=="#")G(),m=u+1;else if(q==".")G(),i=u;else if(q==":")G(),k=u;else if(q=="[")G(),e=u,r={};else if(q=="(")k>=0&&(r={name:c(k+1,u),value:null},o.pseudos.push(r)),f=u;else if(q==" "&&l!=q){G();k>=0&&o.pseudos.push({name:c(k+1,u)});o.loops=o.pseudos.length||o.attrs.length||o.classes.length;o.oquery=
o.query=c(n,u);o.otag=o.tag=o.oper?null:o.tag||"*";if(o.tag)o.tag=o.tag.toUpperCase();if(d.length&&d[d.length-1].oper)o.infixOper=d.pop(),o.query=o.infixOper.query+" "+o.query;d.push(o);o=null}return d},m=function(a,b){return!a?b:!b?a:function(){return a.apply(window,arguments)&&b.apply(window,arguments)}},j=function(a,b){var c=b||[];a&&c.push(a);return c},l=function(a){return 1==a.nodeType},q=function(a,b){return!a?"":b=="class"?a.className||"":b=="for"?a.htmlFor||"":b=="style"?a.style.cssText||
"":(h?a.getAttribute(b):a.getAttribute(b,2))||""},u={"*=":function(a,b){return function(c){return q(c,a).indexOf(b)>=0}},"^=":function(a,b){return function(c){return q(c,a).indexOf(b)==0}},"$=":function(a,b){return function(c){c=" "+q(c,a);return c.lastIndexOf(b)==c.length-b.length}},"~=":function(a,b){var c=" "+b+" ";return function(b){return(" "+q(b,a)+" ").indexOf(c)>=0}},"|=":function(a,b){var c=" "+b+"-";return function(d){d=" "+q(d,a);return d==b||d.indexOf(c)==0}},"=":function(a,b){return function(c){return q(c,
a)==b}}},G=typeof a.doc.firstChild.nextElementSibling=="undefined",v=!G?"nextElementSibling":"nextSibling",R=!G?"previousElementSibling":"previousSibling",M=G?l:k,X=function(a){for(;a=a[R];)if(M(a))return!1;return!0},Y=function(a){for(;a=a[v];)if(M(a))return!1;return!0},H=function(a){var b=a.parentNode,c=0,d=b[f],e=a._i||-1,h=b._l||-1;if(!d)return-1;d=d.length;if(h==d&&e>=0&&h>=0)return e;b._l=d;e=-1;for(b=b.firstElementChild||b.firstChild;b;b=b[v])if(M(b))b._i=++c,a===b&&(e=c);return e},E=function(a){return!(H(a)%
2)},J=function(a){return H(a)%2},w={checked:function(){return function(a){return!!("checked"in a?a.checked:a.selected)}},"first-child":function(){return X},"last-child":function(){return Y},"only-child":function(){return function(a){return!X(a)?!1:!Y(a)?!1:!0}},empty:function(){return function(a){for(var b=a.childNodes,a=a.childNodes.length-1;a>=0;a--){var c=b[a].nodeType;if(c===1||c==3)return!1}return!0}},contains:function(a,b){var c=b.charAt(0);if(c=='"'||c=="'")b=b.slice(1,-1);return function(a){return a.innerHTML.indexOf(b)>=
0}},not:function(a,b){var c=i(b)[0],d={el:1};if(c.tag!="*")d.tag=1;if(!c.classes.length)d.classes=1;var e=F(c,d);return function(a){return!e(a)}},"nth-child":function(a,b){var c=parseInt;if(b=="odd")return J;else if(b=="even")return E;if(b.indexOf("n")!=-1){var d=b.split("n",2),e=d[0]?d[0]=="-"?-1:c(d[0]):1,f=d[1]?c(d[1]):0,g=0,h=-1;e>0?f<0?f=f%e&&e+f%e:f>0&&(f>=e&&(g=f-f%e),f%=e):e<0&&(e*=-1,f>0&&(h=f,f%=e));if(e>0)return function(a){a=H(a);return a>=g&&(h<0||a<=h)&&a%e==f};else b=f}var k=c(b);return function(a){return H(a)==
k}}},C=a.isIE<9||dojo.isIE&&dojo.isQuirks?function(a){var b=a.toLowerCase();b=="class"&&(a="className");return function(c){return h?c.getAttribute(a):c[a]||c[b]}}:function(a){return function(b){return b&&b.getAttribute&&b.hasAttribute(a)}},F=function(a,b){if(!a)return k;var b=b||{},d=null;"el"in b||(d=m(d,l));"tag"in b||a.tag!="*"&&(d=m(d,function(b){return b&&b.tagName==a.getTag()}));"classes"in b||c(a.classes,function(a,b){var c=RegExp("(?:^|\\s)"+a+"(?:\\s|$)");d=m(d,function(a){return c.test(a.className)});
d.count=b});"pseudos"in b||c(a.pseudos,function(a){var b=a.name;w[b]&&(d=m(d,w[b](b,a.value)))});"attrs"in b||c(a.attrs,function(a){var b,c=a.attr;a.type&&u[a.type]?b=u[a.type](c,a.matchFor):c.length&&(b=C(c));b&&(d=m(d,b))});"id"in b||a.id&&(d=m(d,function(b){return!!b&&b.id==a.id}));d||"default"in b||(d=k);return d},A=function(a){return function(b,c,d){for(;b=b[v];)if(!G||l(b)){(!d||W(b,d))&&a(b)&&c.push(b);break}return c}},K=function(a){return function(b,c,d){for(b=b[v];b;){if(M(b)){if(d&&!W(b,
d))break;a(b)&&c.push(b)}b=b[v]}return c}},L=function(a){a=a||k;return function(b,c,d){for(var e=0,h=b[f];b=h[e++];)M(b)&&(!d||W(b,d))&&a(b,e)&&c.push(b);return c}},T={},U=function(b){var c=T[b.query];if(c)return c;var d=b.infixOper,d=d?d.oper:"",f=F(b,{el:1}),g="*"==b.tag,h=a.doc.getElementsByClassName;if(d){h={el:1};if(g)h.tag=1;f=F(b,h);"+"==d?c=A(f):"~"==d?c=K(f):">"==d&&(c=L(f))}else if(b.id)f=!b.loops&&g?k:F(b,{el:1,id:1}),c=function(c,d){var e=a.byId(b.id,c.ownerDocument||c);if(e&&f(e))if(9==
c.nodeType)return j(e,d);else{for(var g=e.parentNode;g;){if(g==c)break;g=g.parentNode}if(g)return j(e,d)}};else if(h&&/\{\s*\[native code\]\s*\}/.test(String(h))&&b.classes.length&&!e)var f=F(b,{el:1,classes:1,id:1}),i=b.classes.join(" "),c=function(a,b,c){for(var b=j(0,b),d,e=0,g=a.getElementsByClassName(i);d=g[e++];)f(d,a)&&W(d,c)&&b.push(d);return b};else!g&&!b.loops?c=function(a,c,d){for(var c=j(0,c),e=0,f=a.getElementsByTagName(b.getTag());a=f[e++];)W(a,d)&&c.push(a);return c}:(f=F(b,{el:1,tag:1,
id:1}),c=function(a,c,d){for(var c=j(0,c),e,g=0,h=a.getElementsByTagName(b.getTag());e=h[g++];)f(e,a)&&W(e,d)&&c.push(e);return c});return T[b.query]=c},V={},P={},I=function(a){var c=i(b(a));if(c.length==1){var e=U(c[0]);return function(a){if(a=e(a,new d))a.nozip=!0;return a}}return function(a){for(var a=j(a),b,d,e=c.length,f,g,h=0;h<e;h++){g=[];b=c[h];d=a.length-1;if(d>0)f={},g.nozip=!0;d=U(b);for(var k=0;b=a[k];k++)d(b,g,f);if(!g.length)break;a=g}return g}},Q=navigator.userAgent,Q=a.isWebKit&&Q.indexOf("WebKit/")>
0&&parseFloat(Q.split("WebKit/")[1])>528,D=a.isIE?"commentStrip":"nozip",O=!!a.doc.querySelectorAll&&(!a.isSafari||a.isSafari>3.1||Q),$=/n\+\d|([^ ])?([>~+])([^ =])?/g,aa=function(a,b,c,d){return c?(b?b+" ":"")+c+(d?" "+d:""):a},Z=function(b,c){b=b.replace($,aa);if(O){var d=P[b];if(d&&!c)return d}if(d=V[b])return d;var d=b.charAt(0),f=-1==b.indexOf(" ");b.indexOf("#")>=0&&f&&(c=!0);if(O&&!c&&">~+".indexOf(d)==-1&&(!a.isIE||b.indexOf(":")==-1)&&!(e&&b.indexOf(".")>=0)&&b.indexOf(":contains")==-1&&
b.indexOf(":checked")==-1&&b.indexOf("|=")==-1){var g=">~+".indexOf(b.charAt(b.length-1))>=0?b+" *":b;return P[b]=function(a){try{if(!(9==a.nodeType||f))throw"";var c=a.querySelectorAll(g);c[D]=!0;return c}catch(d){return Z(b,!0)(a)}}}else{var h=b.split(/\s*,\s*/);return V[b]=h.length<2?I(b):function(a){for(var b=0,c=[],d;d=h[b++];)c=c.concat(I(d)(a));return c}}},S=0,ba=a.isIE?function(a){return h?a.getAttribute("_uid")||a.setAttribute("_uid",++S)||S:a.uniqueID}:function(a){return a._uid||(a._uid=
++S)},W=function(a,b){if(!b)return 1;var c=ba(a);return!b[c]?b[c]=1:0},ca=function(b){if(b&&b.nozip)return d._wrap?d._wrap(b):b;var c=new d;if(!b||!b.length)return c;b[0]&&c.push(b[0]);if(b.length<2)return c;S++;if(a.isIE&&h){var e=S+"";b[0].setAttribute("_zipIdx",e);for(var f=1,g;g=b[f];f++)b[f].getAttribute("_zipIdx")!=e&&c.push(g),g.setAttribute("_zipIdx",e)}else if(a.isIE&&b.commentStrip)try{for(f=1;g=b[f];f++)l(g)&&c.push(g)}catch(k){}else{b[0]&&(b[0]._zipIdx=S);for(f=1;g=b[f];f++)b[f]._zipIdx!=
S&&c.push(g),g._zipIdx=S}return c};a.query=function(b,c){d=a._NodeListCtor;if(!b)return new d;if(b.constructor==d)return b;if(typeof b!="string")return new d(b);if(typeof c=="string"&&(c=a.byId(c),!c))return new d;var c=c||a.doc,e=c.ownerDocument||c.documentElement;h=c.contentType&&c.contentType=="application/xml"||a.isOpera&&(c.doctype||e.toString()=="[object XMLDocument]")||!!e&&(a.isIE?e.xml:c.xmlVersion||e.xmlVersion);return(e=Z(b)(c))&&e.nozip&&!d._wrap?e:ca(e)};a.query.pseudos=w;a._filterQueryResult=
function(b,c,d){for(var e=new a._NodeListCtor,f=i(c),f=f.length==1&&!/[^\w#\.]/.test(c)?F(f[0]):function(a){return dojo.query(c,d).indexOf(a)!=-1},g=0,h;h=b[g];g++)f(h)&&e.push(h);return e}},b=function(){acme={trim:function(a){for(var a=a.replace(/^\s+/,""),b=a.length-1;b>=0;b--)if(/\S/.test(a.charAt(b))){a=a.substring(0,b+1);break}return a},forEach:function(a,b,c){if(a&&a.length)for(var d=0,e=a.length;d<e;++d)b.call(c||window,a[d],d,a)},byId:function(a,b){return typeof a=="string"?(b||document).getElementById(a):
a},doc:document,NodeList:Array};var a=navigator,b=a.userAgent,a=a.appVersion,c=parseFloat(a);acme.isOpera=b.indexOf("Opera")>=0?c:void 0;acme.isKhtml=a.indexOf("Konqueror")>=0?c:void 0;acme.isWebKit=parseFloat(b.split("WebKit/")[1])||void 0;acme.isChrome=parseFloat(b.split("Chrome/")[1])||void 0;if((b=Math.max(a.indexOf("WebKit"),a.indexOf("Safari"),0))&&!acme.isChrome)if(acme.isSafari=parseFloat(a.split("Version/")[1]),!acme.isSafari||parseFloat(a.substr(b+7))<=419.3)acme.isSafari=2;if(document.all&&
!acme.isOpera)acme.isIE=parseFloat(a.split("MSIE ")[1])||void 0;Array._wrap=function(a){return a};return acme};this.dojo?(dojo.provide("dojo._base.query"),a(this.queryPortability||this.acme||dojo)):a(this.queryPortability||this.acme||b())}());dojo._hasResource["dojo._base.xhr"]||(dojo._hasResource["dojo._base.xhr"]=!0,dojo.provide("dojo._base.xhr"),function(){var a=dojo,b=a.config;dojo.fieldToObject=function(b){var c=null;if(b=a.byId(b)){var d=b.name,e=(b.type||"").toLowerCase();if(d&&e&&!b.disabled)if(e==
"radio"||e=="checkbox"){if(b.checked)c=b.value}else b.multiple?(c=[],a.query("option",b).forEach(function(a){a.selected&&c.push(a.value)})):c=b.value}return c};dojo.formToObject=function(b){var c={};a.forEach(dojo.byId(b).elements,function(b){var d=b.name,e=(b.type||"").toLowerCase();if(d&&e&&"file|submit|image|reset|button|".indexOf(e)==-1&&!b.disabled){b=a.fieldToObject(b);if(b!==null){var g=c[d];typeof g=="string"?c[d]=[g,b]:a.isArray(g)?g.push(b):c[d]=b}if(e=="image")c[d+".x"]=c[d+".y"]=c[d].x=
c[d].y=0}});return c};dojo.objectToQuery=function(b){var c=encodeURIComponent,d=[],e={},g;for(g in b){var h=b[g];if(h!=e[g]){var k=c(g)+"=";if(a.isArray(h))for(var i=0;i<h.length;i++)d.push(k+c(h[i]));else d.push(k+c(h))}}return d.join("&")};dojo.formToQuery=function(b){return a.objectToQuery(a.formToObject(b))};dojo.formToJson=function(b,c){return a.toJson(a.formToObject(b),c)};dojo.queryToObject=function(b){var c={},b=b.split("&"),d=decodeURIComponent;a.forEach(b,function(b){if(b.length){var e=
b.split("="),b=d(e.shift()),e=d(e.join("="));typeof c[b]=="string"&&(c[b]=[c[b]]);a.isArray(c[b])?c[b].push(e):c[b]=e}});return c};dojo._blockAsync=!1;var c=a._contentHandlers=dojo.contentHandlers={text:function(a){return a.responseText},json:function(b){return a.fromJson(b.responseText||null)},"json-comment-filtered":function(b){dojo.config.useCommentedJson||console.warn("Consider using the standard mimetype:application/json. json-commenting can introduce security issues. To decrease the chances of hijacking, use the standard the 'json' handler and prefix your json with: {}&&\nUse djConfig.useCommentedJson=true to turn off this message.");
var b=b.responseText,c=b.indexOf("/*"),d=b.lastIndexOf("*/");if(c==-1||d==-1)throw Error("JSON was not comment filtered");return a.fromJson(b.substring(c+2,d))},javascript:function(b){return a.eval(b.responseText)},xml:function(b){var c=b.responseXML;if(a.isIE&&(!c||!c.documentElement)){var d=function(a){return"MSXML"+a+".DOMDocument"},d=["Microsoft.XMLDOM",d(6),d(4),d(3),d(2)];a.some(d,function(a){try{var d=new ActiveXObject(a);d.async=!1;d.loadXML(b.responseText);c=d}catch(e){return!1}return!0})}return c},
"json-comment-optional":function(a){return a.responseText&&/^[^{\[]*\/\*/.test(a.responseText)?c["json-comment-filtered"](a):c.json(a)}};dojo._ioSetArgs=function(c,d,e,g){var h={args:c,url:c.url},k=null;if(c.form){var k=a.byId(c.form),m=k.getAttributeNode("action");h.url=h.url||(m?m.value:null);k=a.formToObject(k)}m=[{}];k&&m.push(k);c.content&&m.push(c.content);c.preventCache&&m.push({"dojo.preventCache":(new Date).valueOf()});h.query=a.objectToQuery(a.mixin.apply(null,m));h.handleAs=c.handleAs||
"text";var j=new a.Deferred(d);j.addCallbacks(e,function(a){return g(a,j)});var l=c.load;l&&a.isFunction(l)&&j.addCallback(function(a){return l.call(c,a,h)});var n=c.error;n&&a.isFunction(n)&&j.addErrback(function(a){return n.call(c,a,h)});var p=c.handle;p&&a.isFunction(p)&&j.addBoth(function(a){return p.call(c,a,h)});b.ioPublish&&a.publish&&h.args.ioPublish!==!1&&(j.addCallbacks(function(b){a.publish("/dojo/io/load",[j,b]);return b},function(b){a.publish("/dojo/io/error",[j,b]);return b}),j.addBoth(function(b){a.publish("/dojo/io/done",
[j,b]);return b}));j.ioArgs=h;return j};var d=function(a){a.canceled=!0;var b=a.ioArgs.xhr,c=typeof b.abort;(c=="function"||c=="object"||c=="unknown")&&b.abort();a=a.ioArgs.error;if(!a)a=Error("xhr cancelled"),a.dojoType="cancel";return a},e=function(a){a=c[a.ioArgs.handleAs](a.ioArgs.xhr);return a===void 0?null:a},h=function(a,b){b.ioArgs.args.failOk||console.error(a);return a},k=null,g=[],m=0,j=function(c){m<=0&&(m=0,b.ioPublish&&a.publish&&(!c||c&&c.ioArgs.args.ioPublish!==!1)&&a.publish("/dojo/io/stop"))},
l=function(){var b=(new Date).getTime();if(!a._blockAsync)for(var c=0,d;c<g.length&&(d=g[c]);c++){var e=d.dfd,h=function(){if(!e||e.canceled||!d.validCheck(e))g.splice(c--,1),m-=1;else if(d.ioCheck(e))g.splice(c--,1),d.resHandle(e),m-=1;else if(e.startTime&&e.startTime+(e.ioArgs.args.timeout||0)<b){g.splice(c--,1);var a=Error("timeout exceeded");a.dojoType="timeout";e.errback(a);e.cancel();m-=1}};if(dojo.config.debugAtAllCosts)h.call(this);else try{h.call(this)}catch(i){e.errback(i)}}j(e);g.length||
(clearInterval(k),k=null)};dojo._ioCancelAll=function(){try{a.forEach(g,function(a){try{a.dfd.cancel()}catch(b){}})}catch(b){}};a.isIE&&a.addOnWindowUnload(a._ioCancelAll);a._ioNotifyStart=function(c){b.ioPublish&&a.publish&&c.ioArgs.args.ioPublish!==!1&&(m||a.publish("/dojo/io/start"),m+=1,a.publish("/dojo/io/send",[c]))};a._ioWatch=function(a,b,c,d){var e=a.ioArgs.args;if(e.timeout)a.startTime=(new Date).getTime();g.push({dfd:a,validCheck:b,ioCheck:c,resHandle:d});k||(k=setInterval(l,50));e.sync&&
l()};var y=function(a){return a.ioArgs.xhr.readyState},x=function(a){return 4==a.ioArgs.xhr.readyState},N=function(b){var c=b.ioArgs.xhr;if(a._isDocumentOk(c))b.callback(b);else{var d=Error("Unable to load "+b.ioArgs.url+" status:"+c.status);d.status=c.status;d.responseText=c.responseText;b.errback(d)}};dojo._ioAddQueryToUrl=function(a){if(a.query.length)a.url+=(a.url.indexOf("?")==-1?"?":"&")+a.query,a.query=null};dojo.xhr=function(b,c,g){var k=a._ioSetArgs(c,d,e,h),i=k.ioArgs,m=i.xhr=a._xhrObj(i.args);
if(!m)return k.cancel(),k;"postData"in c?i.query=c.postData:"putData"in c?i.query=c.putData:"rawBody"in c?i.query=c.rawBody:(arguments.length>2&&!g||"POST|PUT".indexOf(b.toUpperCase())==-1)&&a._ioAddQueryToUrl(i);m.open(b,i.url,c.sync!==!0,c.user||void 0,c.password||void 0);if(c.headers)for(var j in c.headers)j.toLowerCase()==="content-type"&&!c.contentType?c.contentType=c.headers[j]:c.headers[j]&&m.setRequestHeader(j,c.headers[j]);m.setRequestHeader("Content-Type",c.contentType||"application/x-www-form-urlencoded");
(!c.headers||!("X-Requested-With"in c.headers))&&m.setRequestHeader("X-Requested-With","XMLHttpRequest");a._ioNotifyStart(k);if(dojo.config.debugAtAllCosts)m.send(i.query);else try{m.send(i.query)}catch(l){i.error=l,k.cancel()}a._ioWatch(k,y,x,N);return k};dojo.xhrGet=function(b){return a.xhr("GET",b)};dojo.rawXhrPost=dojo.xhrPost=function(b){return a.xhr("POST",b,!0)};dojo.rawXhrPut=dojo.xhrPut=function(b){return a.xhr("PUT",b,!0)};dojo.xhrDelete=function(b){return a.xhr("DELETE",b)}}());dojo._hasResource["dojo._base.fx"]||
(dojo._hasResource["dojo._base.fx"]=!0,dojo.provide("dojo._base.fx"),function(){var a=dojo,b=a._mixin;dojo._Line=function(a,b){this.start=a;this.end=b};dojo._Line.prototype.getValue=function(a){return(this.end-this.start)*a+this.start};dojo.Animation=function(c){b(this,c);if(a.isArray(this.curve))this.curve=new a._Line(this.curve[0],this.curve[1])};a._Animation=a.Animation;a.extend(dojo.Animation,{duration:350,repeat:0,rate:20,_percent:0,_startRepeatCount:0,_getStep:function(){var a=this._percent,
b=this.easing;return b?b(a):a},_fire:function(b,c){var d=c||[];if(this[b])if(a.config.debugAtAllCosts)this[b].apply(this,d);else try{this[b].apply(this,d)}catch(e){console.error("exception in animation handler for:",b),console.error(e)}return this},play:function(a,b){this._delayTimer&&this._clearTimer();if(b)this._stopTimer(),this._active=this._paused=!1,this._percent=0;else if(this._active&&!this._paused)return this;this._fire("beforeBegin",[this.node]);var c=a||this.delay,d=dojo.hitch(this,"_play",
b);if(c>0)return this._delayTimer=setTimeout(d,c),this;d();return this},_play:function(){this._delayTimer&&this._clearTimer();this._startTime=(new Date).valueOf();this._paused&&(this._startTime-=this.duration*this._percent);this._active=!0;this._paused=!1;var a=this.curve.getValue(this._getStep());if(!this._percent){if(!this._startRepeatCount)this._startRepeatCount=this.repeat;this._fire("onBegin",[a])}this._fire("onPlay",[a]);this._cycle();return this},pause:function(){this._delayTimer&&this._clearTimer();
this._stopTimer();if(!this._active)return this;this._paused=!0;this._fire("onPause",[this.curve.getValue(this._getStep())]);return this},gotoPercent:function(a,b){this._stopTimer();this._active=this._paused=!0;this._percent=a;b&&this.play();return this},stop:function(a){this._delayTimer&&this._clearTimer();if(!this._timer)return this;this._stopTimer();if(a)this._percent=1;this._fire("onStop",[this.curve.getValue(this._getStep())]);this._active=this._paused=!1;return this},status:function(){return this._active?
this._paused?"paused":"playing":"stopped"},_cycle:function(){if(this._active){var a=((new Date).valueOf()-this._startTime)/this.duration;a>=1&&(a=1);this._percent=a;this.easing&&(a=this.easing(a));this._fire("onAnimate",[this.curve.getValue(a)]);if(this._percent<1)this._startTimer();else{this._active=!1;if(this.repeat>0)this.repeat--,this.play(null,!0);else if(this.repeat==-1)this.play(null,!0);else if(this._startRepeatCount)this.repeat=this._startRepeatCount,this._startRepeatCount=0;this._percent=
0;this._fire("onEnd",[this.node]);!this.repeat&&this._stopTimer()}}return this},_clearTimer:function(){clearTimeout(this._delayTimer);delete this._delayTimer}});var c=0,d=null,e={run:function(){}};a.extend(a.Animation,{_startTimer:function(){if(!this._timer)this._timer=a.connect(e,"run",this,"_cycle"),c++;d||(d=setInterval(a.hitch(e,"run"),this.rate))},_stopTimer:function(){if(this._timer)a.disconnect(this._timer),this._timer=null,c--;c<=0&&(clearInterval(d),d=null,c=0)}});var h=a.isIE?function(b){var c=
b.style;if(!c.width.length&&a.style(b,"width")=="auto")c.width="auto"}:function(){};dojo._fade=function(c){c.node=a.byId(c.node);var d=b({properties:{}},c),c=d.properties.opacity={};c.start=!("start"in d)?function(){return+a.style(d.node,"opacity")||0}:d.start;c.end=d.end;c=a.animateProperty(d);a.connect(c,"beforeBegin",a.partial(h,d.node));return c};dojo.fadeIn=function(c){return a._fade(b({end:1},c))};dojo.fadeOut=function(c){return a._fade(b({end:0},c))};dojo._defaultEasing=function(a){return 0.5+
Math.sin((a+1.5)*Math.PI)/2};var k=function(b){this._properties=b;for(var c in b){var d=b[c];if(d.start instanceof a.Color)d.tempColor=new a.Color}};k.prototype.getValue=function(b){var c={},d;for(d in this._properties){var e=this._properties[d],h=e.start;h instanceof a.Color?c[d]=a.blendColors(h,e.end,b,e.tempColor).toCss():a.isArray(h)||(c[d]=(e.end-h)*b+h+(d!="opacity"?e.units||"px":0))}return c};dojo.animateProperty=function(c){var d=c.node=a.byId(c.node);if(!c.easing)c.easing=a._defaultEasing;
c=new a.Animation(c);a.connect(c,"beforeBegin",c,function(){var c={},e;for(e in this.properties){if(e=="width"||e=="height")this.node.display="block";var h=this.properties[e];a.isFunction(h)&&(h=h(d));h=c[e]=b({},a.isObject(h)?h:{end:h});if(a.isFunction(h.start))h.start=h.start(d);if(a.isFunction(h.end))h.end=h.end(d);var g=e.toLowerCase().indexOf("color")>=0,m=function(b,c){var d={height:b.offsetHeight,width:b.offsetWidth}[c];if(d!==void 0)return d;d=a.style(b,c);return c=="opacity"?+d:g?d:parseFloat(d)};
if("end"in h){if(!("start"in h))h.start=m(d,e)}else h.end=m(d,e);g?(h.start=new a.Color(h.start),h.end=new a.Color(h.end)):h.start=e=="opacity"?+h.start:parseFloat(h.start)}this.curve=new k(c)});a.connect(c,"onAnimate",a.hitch(a,"style",c.node));return c};dojo.anim=function(b,c,d,e,h,k){return a.animateProperty({node:b,duration:d||a.Animation.prototype.duration,properties:c,easing:e,onEnd:h}).play(k||0)}}());dojo._hasResource["dojo._base.browser"]||(dojo._hasResource["dojo._base.browser"]=!0,dojo.provide("dojo._base.browser"),
dojo.forEach(dojo.config.require,function(a){dojo.require(a)}));dojo._hasResource["dojo._base"]||(dojo._hasResource["dojo._base"]=!0,dojo.provide("dojo._base"));dojo.isBrowser&&(document.readyState==="complete"||dojo.config.afterOnLoad)&&window.setTimeout(dojo._loadInit,100)})();
var DecodeStream=function(){function a(){this.bufferLength=this.pos=0;this.eof=!1;this.buffer=null}a.prototype={ensureBuffer:function(a){var c=this.buffer,d=c?c.byteLength:0;if(a<d)return c;for(var j=512;j<a;)j<<=1;a=new Uint8Array(j);for(j=0;j<d;++j)a[j]=c[j];return this.buffer=a},getByte:function(){for(var a=this.pos;this.bufferLength<=a;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(a){var c=this.pos;if(a){this.ensureBuffer(c+a);for(a=c+a;!this.eof&&
this.bufferLength<a;)this.readBlock();var d=this.bufferLength;a>d&&(a=d)}else{for(;!this.eof;)this.readBlock();a=this.bufferLength}this.pos=a;return this.buffer.subarray(c,a)},lookChar:function(){for(var a=this.pos;this.bufferLength<=a;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var a=this.pos;this.bufferLength<=a;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(a,
c,d){for(var j=a+c;this.bufferLength<=j&&!this.eof;)this.readBlock();return new Stream(this.buffer,a,c,d)},skip:function(a){a||(a=1);this.pos+=a},reset:function(){this.pos=0}};return a}(),FlateStream=function(){function a(a){throw Error(a);}function b(b){var c=0,d=b[c++],f=b[c++];(d==-1||f==-1)&&a("Invalid header in flate stream");(d&15)!=8&&a("Unknown compression method in flate stream");((d<<8)+f)%31!=0&&a("Bad FCHECK in flate stream");f&32&&a("FDICT bit set in flate stream");this.bytes=b;this.bytesPos=
c;this.codeBuf=this.codeSize=0;DecodeStream.call(this)}var c=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),d=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),j=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,
868353,876545]),l=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59E4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,
524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,
589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,
589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,
590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,
524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,
589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,
589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],m=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];b.prototype=Object.create(DecodeStream.prototype);b.prototype.getBits=function(b){for(var c=this.codeSize,d=this.codeBuf,f=this.bytes,i=this.bytesPos,m;c<b;)typeof(m=
f[i++])=="undefined"&&a("Bad encoding in flate stream"),d|=m<<c,c+=8;this.codeBuf=d>>b;this.codeSize=c-b;this.bytesPos=i;return d&(1<<b)-1};b.prototype.getCode=function(b){for(var c=b[0],d=b[1],b=this.codeSize,f=this.codeBuf,i=this.bytes,m=this.bytesPos;b<d;){var j;typeof(j=i[m++])=="undefined"&&a("Bad encoding in flate stream");f|=j<<b;b+=8}d=c[f&(1<<d)-1];c=d>>16;d&=65535;(b==0||b<c||c==0)&&a("Bad encoding in flate stream");this.codeBuf=f>>c;this.codeSize=b-c;this.bytesPos=m;return d};b.prototype.generateHuffmanTable=
function(a){for(var b=a.length,c=0,d=0;d<b;++d)a[d]>c&&(c=a[d]);for(var i=1<<c,m=new Uint32Array(i),j=1,l=0,r=2;j<=c;++j,l<<=1,r<<=1)for(var s=0;s<b;++s)if(a[s]==j){for(var g=0,p=l,d=0;d<j;++d)g=g<<1|p&1,p>>=1;for(d=g;d<i;d+=r)m[d]=j<<16|s;++l}return[m,c]};b.prototype.readBlock=function(){function b(a,c,d,e,f){for(a=a.getBits(d)+e;a-- >0;)c[o++]=f}var h=this.getBits(3);if(h&1)this.eof=!0;h>>=1;if(h==0){var e=this.bytes,f=this.bytesPos,i;typeof(i=e[f++])=="undefined"&&a("Bad block header in flate stream");
var n=i;typeof(i=e[f++])=="undefined"&&a("Bad block header in flate stream");n|=i<<8;typeof(i=e[f++])=="undefined"&&a("Bad block header in flate stream");h=i;typeof(i=e[f++])=="undefined"&&a("Bad block header in flate stream");h|=i<<8;h!=(~n&65535)&&a("Bad uncompressed block length in flate stream");this.codeSize=this.codeBuf=0;i=this.bufferLength;h=this.ensureBuffer(i+n);this.bufferLength=n=i+n;for(var t=i;t<n;++t){if(typeof(i=e[f++])=="undefined"){this.eof=!0;break}h[t]=i}this.bytesPos=f}else{if(h==
1)f=l,i=m;else if(h==2){h=this.getBits(5)+257;i=this.getBits(5)+1;for(var e=this.getBits(4)+4,f=Array(c.length),o=0;o<e;)f[c[o++]]=this.getBits(3);f=this.generateHuffmanTable(f);o=e=0;i=h+i;for(n=Array(i);o<i;)t=this.getCode(f),t==16?b(this,n,2,3,e):t==17?b(this,n,3,3,e=0):t==18?b(this,n,7,11,e=0):n[o++]=e=t;f=this.generateHuffmanTable(n.slice(0,h));i=this.generateHuffmanTable(n.slice(h,i))}else a("Unknown block type in flate stream");n=(h=this.buffer)?h.length:0;for(t=this.bufferLength;;){var r=
this.getCode(f);if(r<256){if(t+1>=n)h=this.ensureBuffer(t+1),n=h.length;h[t++]=r}else{if(r==256){this.bufferLength=t;break}r-=257;var r=d[r],s=r>>16;s>0&&(s=this.getBits(s));e=(r&65535)+s;r=this.getCode(i);r=j[r];s=r>>16;s>0&&(s=this.getBits(s));r=(r&65535)+s;if(t+e>=n)h=this.ensureBuffer(t+e),n=h.length;for(s=0;s<e;++s,++t)h[t]=h[t-r]}}}};return b}();
(function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(b){var c,d,e,f;this.data=b;this.pos=8;this.palette=[];this.imgData=[];this.transparency={};for(d=this.animation=null;;){c=this.readUInt32();b=function(){var a;a=[];for(e=0;e<4;e++)a.push(String.fromCharCode(this.data[this.pos++]));return a}.call(this).join("");switch(b){case "IHDR":this.width=this.readUInt32();this.height=this.readUInt32();this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];
this.compressionMethod=this.data[this.pos++];this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];break;case "acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||Infinity,frames:[]};break;case "PLTE":this.palette=this.read(c);break;case "fcTL":d&&this.animation.frames.push(d);this.pos+=4;d={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};b=this.readUInt16();c=this.readUInt16()||100;d.delay=
1E3*b/c;d.disposeOp=this.data[this.pos++];d.blendOp=this.data[this.pos++];d.data=[];break;case "IDAT":case "fdAT":b==="fdAT"&&(this.pos+=4,c-=4);b=(d!=null?d.data:void 0)||this.imgData;for(e=0;0<=c?e<c:e>c;0<=c?e++:e--)b.push(this.data[this.pos++]);break;case "tRNS":this.transparency={};switch(this.colorType){case 3:this.transparency.indexed=this.read(c);c=255-this.transparency.indexed.length;if(c>0)for(e=0;e<c;e++)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(c)[0];
break;case 2:this.transparency.rgb=this.read(c)}break;case "IEND":d&&this.animation.frames.push(d);var i;a:switch(this.colorType){case 0:case 3:case 4:i=1;break a;case 2:case 6:i=3}this.colors=i;this.hasAlphaChannel=(f=this.colorType)===4||f===6;d=this.colors+(this.hasAlphaChannel?1:0);this.pixelBitlength=this.bits*d;var j;a:switch(this.colors){case 1:j="DeviceGray";break a;case 3:j="DeviceRGB"}this.colorSpace=j;this.imgData=new Uint8Array(this.imgData);return;default:this.pos+=c}this.pos+=4}}var d,
j,l;a.load=function(d,k,h){var e;typeof k==="function"&&(h=k);e=new XMLHttpRequest;e.open("GET",d,!0);e.responseType="arraybuffer";e.onload=b(function(){var b;b=new Uint8Array(e.response||e.mozResponseArrayBuffer);b=new a(b);typeof(k!=null?k.getContext:void 0)==="function"&&b.render(k);return typeof h==="function"?h(b):void 0},this);return e.send(null)};a.prototype.read=function(a){var b,c;c=[];for(b=0;0<=a?b<a:b>a;0<=a?b++:b--)c.push(this.data[this.pos++]);return c};a.prototype.readUInt32=function(){var a,
b,c,d;a=this.data[this.pos++]<<24;b=this.data[this.pos++]<<16;c=this.data[this.pos++]<<8;d=this.data[this.pos++];return a|b|c|d};a.prototype.readUInt16=function(){var a,b;a=this.data[this.pos++]<<8;b=this.data[this.pos++];return a|b};a.prototype.decodePixels=function(a){var b,c,d,f,i,j,l,o,r,s,g,p,B,z,y;if(a==null)a=this.imgData;if(a.length===0)return[];a=new FlateStream(a);a=a.getBytes();o=this.pixelBitlength/8;B=o*this.width;g=0;r=[];i=a.length;for(s=0;s<i;){b=a[s++];d=0;p=[];switch(b){case 0:for(;d<
B;)p[d++]=a[s++];break;case 1:for(;d<B;)b=a[s++],f=d<o?0:p[d-o],p[d++]=(b+f)%256;break;case 2:for(;d<B;)b=a[s++],c=(d-d%o)/o,z=g===0?0:r[g-1][c][d%o],p[d++]=(z+b)%256;break;case 3:for(;d<B;)b=a[s++],c=(d-d%o)/o,f=d<o?0:p[d-o],z=g===0?0:r[g-1][c][d%o],p[d++]=(b+Math.floor((f+z)/2))%256;break;case 4:for(;d<B;)b=a[s++],c=(d-d%o)/o,f=d<o?0:p[d-o],g===0?z=y=0:(z=r[g-1][c][d%o],y=c===0?0:r[g-1][c-1][d%o]),j=f+z-y,c=Math.abs(j-f),l=Math.abs(j-z),j=Math.abs(j-y),f=c<=l&&c<=j?f:l<=j?z:y,p[d++]=(b+f)%256;break;
default:throw Error("Invalid filter algorithm: "+b);}b=[];for(d=0,f=p.length,z=o;0<=f?d<f:d>f;d+=z)b.push(p.slice(d,d+o));r.push(b);g+=1}return r};a.prototype.decodePalette=function(){var a,b,c,d,f,i,j,l;f=this.palette;i=(b=this.transparency.indexed)!=null?b:[];b=[];d=0;for(c=0,j=f.length;0<=j?c<j:c>j;c+=3)a=(l=i[d++])!=null?l:255,a=f.slice(c,c+3).concat(a),b.push(a);return b};a.prototype.copyToImageData=function(a,b){var c,d,f,i,j,l,o,r,s,g,p,B,z,y;f=this.colors;l=null;c=this.hasAlphaChannel;if(this.palette.length)l=
(i=this._decodedPalette)!=null?i:this._decodedPalette=this.decodePalette(),f=4,c=!0;i=a.data;j=0;for(s=0,B=b.length;s<B;s++){r=b[s];for(g=0,z=r.length;g<z;g++)if(o=r[g],l&&(o=l[o]),f===1)d=o[0],i[j++]=d,i[j++]=d,i[j++]=d,i[j++]=o[1]||255;else{for(p=0,y=o.length;p<y;p++)d=o[p],i[j++]=d;c||(i[j++]=255)}}};j=document.createElement("canvas");l=j.getContext("2d");d=function(a){l.width=a.width;l.height=a.height;l.clearRect(0,0,a.width,a.height);l.putImageData(a,0,0);a=new Image;a.src=j.toDataURL();return a};
a.prototype.decodeFrames=function(a){var b,c,e,f,i,j,l;if(this.animation){j=this.animation.frames;l=[];for(c=0,i=j.length;c<i;c++)b=j[c],e=a.createImageData(b.width,b.height),f=this.decodePixels(new Uint8Array(b.data)),this.copyToImageData(e,f),b.imageData=e,l.push(b.image=d(e));return l}};a.prototype.renderFrame=function(a,b){var c,d;d=this.animation.frames;c=d[b];d=d[b-1];b===0&&a.clearRect(0,0,this.width,this.height);(d!=null?d.disposeOp:void 0)===1?a.clearRect(d.xOffset,d.yOffset,d.width,d.height):
(d!=null?d.disposeOp:void 0)===2&&a.putImageData(d.imageData,d.xOffset,d.yOffset);c.blendOp===0&&a.clearRect(c.xOffset,c.yOffset,c.width,c.height);return a.drawImage(c.image,c.xOffset,c.yOffset)};a.prototype.animate=function(a){var c,d,e,f,i,j;d=0;j=this.animation;f=j.numFrames;e=j.frames;i=j.numPlays;return(c=b(function(){var b,j;b=d++%f;j=e[b];this.renderFrame(a,b);if(f>1&&d/f<i)return this.animation._timeout=setTimeout(c,j.delay)},this))()};a.prototype.stopAnimation=function(){var a;return clearTimeout((a=
this.animation)!=null?a._timeout:void 0)};a.prototype.render=function(a){var b;a._png&&a._png.stopAnimation();a._png=this;a.width=this.width;a.height=this.height;a=a.getContext("2d");return this.animation?(this.decodeFrames(a),this.animate(a)):(b=a.createImageData(this.width,this.height),this.copyToImageData(b,this.decodePixels()),a.putImageData(b,0,0))};return a}();window.PNG=a}).call(this);
if(!dojo._hasResource["dojo.DeferredList"])dojo._hasResource["dojo.DeferredList"]=!0,dojo.provide("dojo.DeferredList"),dojo.DeferredList=function(a,b,c,d){var j=[];dojo.Deferred.call(this);var l=this;a.length===0&&!b&&this.resolve([0,[]]);var m=0;dojo.forEach(a,function(k,h){function e(b,c){j[h]=[b,c];m++;m===a.length&&l.resolve(j)}k.then(function(a){b?l.resolve([h,a]):e(!0,a)},function(a){c?l.reject(a):e(!1,a);if(d)return null;throw a;})})},dojo.DeferredList.prototype=new dojo.Deferred,dojo.DeferredList.prototype.gatherResults=
function(a){a=new dojo.DeferredList(a,!1,!0,!1);a.addCallback(function(a){var c=[];dojo.forEach(a,function(a){c.push(a[1])});return c});return a};dojo.provide("pocjs.InputHandler");dojo.declare("pocjs.InputHandler",null,{keys:[],keyup:function(a){this.keys[a.keyCode]=!1;a.preventDefault()},keydown:function(a){this.keys[a.keyCode]=!0;a.preventDefault()}});dojo.provide("pocjs.Sound");dojo.declare("pocjs.Sound",null,{});
dojo.mixin(pocjs.Sound,{loadSound:function(a){var b=new dojo.Deferred,c=new Audio,d=function(){b.fired==-1&&b.resolve(a)};c.addEventListener("canplay",d,!1);c.addEventListener("loaded",d,!1);c.src="res/snd/"+a+".wav";this[a]=c;return b}});dojo.provide("pocjs.Art");dojo.declare("pocjs.Art",null,{});
pocjs.Art.loadBitmap=function(a,b){var c=this,d=new dojo.Deferred;PNG.load(b,function(b){for(var l=b.width,m=b.height,k=Array(l*m<<0),b=b.decodePixels(),h=new pocjs.gui.Bitmap(l,m),e=0;e<m;e++)for(var f=0;f<l;f++){var i=b[e][f],i=i[3]<<24|i[0]<<16|i[1]<<8|i[2],n=(i&15)>>2;i==-65281&&(n=-1);h.pixels[f+e*l]=n;k[f+e*l]=i}c[a]=h;d.resolve(a)});return d};pocjs.Art.getCol=function(a){return(a>>16&255)*85/255<<16|(a>>8&255)*85/255<<8|(a&255)*85/255};dojo.provide("pocjs.gui.Bitmap");
dojo.declare("pocjs.gui.Bitmap",null,{width:null,height:null,pixels:null,statics:{chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZ.,!?\"'/\\<>()[]{}abcdefghijklmnopqrstuvwxyz_               0123456789+-=*:;\ufffd\ufffd\ufffd\ufffd                      "},constructor:function(a,b){this.width=a;this.height=b;this.pixels=Array(a*b)},draw:function(a,b,c){b<<=0;c<<=0;for(var d=0;d<a.height;d++){var j=d+c;if(!(j<0||j>=this.height))for(var l=0;l<a.width;l++){var m=l+b;m<0||m>=this.width||(this.pixels[m+j*this.width]=a.pixels[l+
d*a.width])}}},flipDraw:function(a,b,c){b<<=0;c<<=0;for(var d=0;d<a.height;d++){var j=d+c;if(!(j<0||j>=this.height))for(var l=0;l<a.width;l++){var m=b+a.width-l-1;m<0||m>=this.width||(this.pixels[m+j*this.width]=a.pixels[l+d*a.width])}}},drawPart:function(a,b,c,d,j,l,m,k){b<<=0;c<<=0;d<<=0;j<<=0;l<<=0;m<<=0;for(var h=0;h<m;h++){var e=h+c;if(!(e<0||e>=this.height))for(var f=0;f<l;f++){var i=f+b;if(!(i<0||i>=this.width)){var n=a.pixels[f+d+(h+j)*a.width];n>=0&&(this.pixels[i+e*this.width]=n*k)}}}},
scalecount:0,scaleDraw:function(a,b,c,d,j,l,m,k,h){for(var e=0;e<k*b;e++){var f=e+d;if(!(f<0||f>=this.height))for(var i=0;i<m*b;i++){var n=i+c;if(!(n<0||n>=this.width)){var t=a.pixels[(i/b<<0)+j+((e/b<<0)+l)*a.width];t>=0&&(this.pixels[n+f*this.width]=t*h)}}}},drawString:function(a,b,c,d){b<<=0;c<<=0;for(var j=0;j<a.length;j++){var l=this.statics.chars.indexOf(a[j]);l<0||this.drawPart(pocjs.Art.font,b+j*6,c,l%42*6,(l/42<<0)*8,5,8,d)}},fill:function(a,b,c,d,j){a<<=0;b<<=0;c<<=0;for(d<<=0;b<d;b++)for(var l=
a;l<c;l++)this.pixels[l+b*this.width]=j}});dojo.provide("pocjs.gui.Bitmap3D");
dojo.declare("pocjs.gui.Bitmap3D",pocjs.gui.Bitmap,{zBuffer:null,zBufferWall:null,xCam:0,yCam:0,zCam:0,rCos:0,rSin:0,fov:0,xCenter:0,yCenter:0,rot:0,"-chains-":{constructor:"manual"},constructor:function(a,b){this.inherited(arguments);this.zBuffer=Array(a*b);this.zBufferWall=Array(a)},render:function(a){for(var b=0;b<this.width;b++)this.zBufferWall[b]=0;for(var c=0;c<this.width*this.height;c++)this.zBuffer[c]=1E4;this.rot=a.player.rot;this.xCam=a.player.x-Math.sin(this.rot)*0.3;this.yCam=a.player.z-
Math.cos(this.rot)*0.3;this.zCam=-0.2+Math.sin(a.player.bobPhase*0.4)*0.01*a.player.bob-a.player.y;this.xCenter=this.width/2;this.yCenter=this.height/3;this.rCos=Math.cos(this.rot);this.rSin=Math.sin(this.rot);this.fov=this.height;for(var a=a.level,b=Math.floor(this.xCam),d=Math.floor(this.yCam),j=d-6;j<=d+6;j++)for(var l=b-6;l<=b+6;l++){var m=a.getBlock(l,j),k=a.getBlock(l+1,j),c=a.getBlock(l,j+1);if(m instanceof pocjs.level.block.DoorBlock){var h=1-m.openness*7/8;k.solidRender?(this.renderWall(l+
h,j+0.5-0.125,l,j+0.5-0.125,m.tex,(m.col&16711422)>>1,0,h),this.renderWall(l,j+0.5+0.125,l+h,j+0.5+0.125,m.tex,(m.col&16711422)>>1,h,0),this.renderWall(l+h,j+0.5+0.125,l+h,j+0.5-0.125,m.tex,m.col,0.375,0.625)):(this.renderWall(l+0.5-0.125,j,l+0.5-0.125,j+h,m.tex,m.col,h,0),this.renderWall(l+0.5+0.125,j+h,l+0.5+0.125,j,m.tex,m.col,0,h),this.renderWall(l+0.5-0.125,j+h,l+0.5+0.125,j+h,m.tex,(m.col&16711422)>>1,0.375,0.625))}m.solidRender?(k.solidRender||this.renderWall(l+1,j+1,l+1,j,m.tex,m.col),c.solidRender||
this.renderWall(l,j+1,l+1,j+1,m.tex,(m.col&16711422)>>1)):(k.solidRender&&this.renderWall(l+1,j,l+1,j+1,k.tex,k.col),c.solidRender&&this.renderWall(l+1,j+1,l,j+1,c.tex,(c.col&16711422)>>1))}for(j=d-6;j<=d+6;j++)for(l=b-6;l<=b+6;l++){m=a.getBlock(l,j);for(h=0;h<m.entities.length;h++){k=m.entities[h];for(c=0;c<k.sprites.length;c++){var e=k.sprites[c];this.renderSprite(k.x+e.x,0-e.y,k.z+e.z,e.tex,e.col)}}for(c=0;c<m.sprites.length;c++)e=m.sprites[c],this.renderSprite(l+e.x,0-e.y,j+e.z,e.tex,e.col)}this.renderFloor(a)},
renderFloor:function(a){for(var b=pocjs.Art.floors.pixels,c=this.height,d=this.width,j=this.xCenter,l=this.yCenter,m=this.fov,k=this.zCam,h=this.rCos,e=this.rSin,f=this.zBuffer,i=this.pixels,n=(this.xCam+0.5)*8,t=(this.yCam+0.5)*8,o=0;o<c;o++){var r=(o+0.5-l)/m,s=!0,g=(4-k*8)/r;r<0&&(s=!1,g=(4+k*8)/-r);for(var r=g*e,p=g*h,B=0;B<d;B++)if(!(f[B+o*d]<=g)){var z=(j-B)/m;z*=g;var y=(z*h+r+n)*2<<0,z=(p-z*e+t)*2<<0,x=a.getBlock(y>>4,z>>4),N=x.floorCol,q=x.floorTex;if(!s)N=x.ceilCol,q=x.ceilTex;q<0?f[B+o*
d]=-1:(f[B+o*d]=g,i[B+o*d]=b[(y&15)+q%8*16+((z&15)+(q/8<<0)*16)*128]*N)}}},renderSprite:function(a,b,c,d,j){var l=this.height,m=this.width,k=this.fov,h=this.rCos,e=this.rSin,f=this.zBuffer,i=this.pixels,n=pocjs.Art.sprites.pixels,a=(a-this.xCam)*2-e*0.2,t=(c-this.yCam)*2-h*0.2,c=t*h+a*e;if(!(c<0.1)){h=this.xCenter-(a*h-t*e)/c*k;e=(b-this.zCam)*2/c*k+this.yCenter;a=l/c;b=h-a;k=h+a;h=e-a;e+=a;var a=Math.ceil(b),t=Math.ceil(k),o=Math.ceil(h),r=Math.ceil(e);a<0&&(a=0);t>m&&(t=m);o<0&&(o=0);r>l&&(r=l);
c*=4;l=d%8*16;for(d=(d/8<<0)*16;o<r;o++)for(var s=(o-h)/(e-h)*16<<0,g=a;g<t;g++){var p=(g-b)/(k-b)*16<<0;f[g+o*m]>c&&(p=n[p+l+(s+d)*128],p>=0&&(i[g+o*m]=p*j,f[g+o*m]=c))}}},renderWall:function(a,b,c,d,j,l,m,k){m===void 0&&(m=0);k===void 0&&(k=1);var h=(a-0.5-this.xCam)*2,e=(b-0.5-this.yCam)*2,b=h*this.rCos-e*this.rSin,a=(-0.5-this.zCam)*2,f=(0.5-this.zCam)*2,e=e*this.rCos+h*this.rSin,i=(c-0.5-this.xCam)*2,n=(d-0.5-this.yCam)*2,d=i*this.rCos-n*this.rSin,c=(-0.5-this.zCam)*2,h=(0.5-this.zCam)*2,i=n*
this.rCos+i*this.rSin;m*=16;k*=16;if(!(e<0.2&&i<0.2)){e<0.2&&(n=(0.2-e)/(i-e),e+=(i-e)*n,b+=(d-b)*n,m+=(k-m)*n);i<0.2&&(n=(0.2-e)/(i-e),i=e+(i-e)*n,d=b+(d-b)*n,k=m+(k-m)*n);var b=this.xCenter-b/e*this.fov,t=this.xCenter-d/i*this.fov;if(!(b>=t)){n=Math.ceil(b);d=Math.ceil(t);n<0&&(n=0);if(d>this.width)d=this.width;var a=a/e*this.fov+this.yCenter,f=f/e*this.fov+this.yCenter,c=c/i*this.fov+this.yCenter,h=h/i*this.fov+this.yCenter,e=1/e,o=1/i,i=o-e;m*=e;k=k*o-m;t=1/(t-b);o=j%8*16;for(j=(j/8<<0)*16;n<
d;n++){var r=(n-b)*t,s=e+i*r;if(!(this.zBufferWall[n]>s)){this.zBufferWall[n]=s;var g=(m+k*r)/s<<0,p=a+(c-a)*r-0.5,B=f+(h-f)*r,z=Math.ceil(p),r=Math.ceil(B);z<0&&(z=0);if(r>this.height)r=this.height;for(B=1/(B-p);z<r;z++)this.pixels[n+z*this.width]=pocjs.Art.walls.pixels[g+o+((16*(z-p)*B<<0)+j)*128]*l,this.zBuffer[n+z*this.width]=1/s*4}}}}},postProcess:function(){for(var a=0;a<this.width*this.height;a++){var b=this.zBuffer[a];if(b<0){var c=a%this.width-this.rot*512/(Math.PI*2)&511;this.pixels[a]=
pocjs.Art.sky.pixels[c+(a/this.width<<0)*512]*4473941}else{var d=a%this.width,j=(a/this.width<<0)*14,c=(a%this.width-this.width/2)/this.width,l=this.pixels[a],b=300-b*6*(c*c*2+1)<<0,b=b+(d+j&3)*4>>4<<4;b<0&&(b=0);b>255&&(b=255);d=l>>16&255;j=l>>8&255;l&=255;d=d*b/255;j=j*b/255;l=l*b/255;this.pixels[a]=d<<16|j<<8|l}}}});dojo.provide("pocjs.gui.Sprite");
dojo.declare("pocjs.gui.Sprite",null,{x:null,y:null,z:null,tex:null,col:2105376,removed:!1,constructor:function(a,b,c,d,j){this.x=a;this.y=b;this.z=c;this.tex=d;this.col=j},tick:function(){}});dojo.provide("pocjs.gui.PoofSprite");dojo.declare("pocjs.gui.PoofSprite",pocjs.gui.Sprite,{life:20,"-chains-":{constructor:"manual"},constructor:function(a,b,c){this.inherited(arguments,[a,b,c,5,2236962])},tick:function(){if(this.life--<=0)this.removed=!0}});dojo.provide("pocjs.gui.RubbleSprite");
dojo.declare("pocjs.gui.RubbleSprite",pocjs.gui.Sprite,{xa:null,ya:null,za:null,"-chains-":{constructor:"manual"},constructor:function(){this.inherited(arguments,[Math.random()-0.5,Math.random()*0.8,Math.random()-0.5,2,5592405]);this.xa=Math.random()-0.5;this.ya=Math.random();this.za=Math.random()-0.5},tick:function(){this.x+=this.xa*0.03;this.y+=this.ya*0.03;this.z+=this.za*0.03;this.ya-=0.1;if(this.y<0&&(this.y=0,this.xa*=0.8,this.za*=0.8,Math.random()<0.04))this.removed=!0}});dojo.provide("pocjs.entities.Item");
dojo.declare("pocjs.entities.Item",null,{icon:null,color:null,name:null,description:null,constructor:function(a,b,c,d){this.icon=a;this.color=b;this.name=c;this.description=d}});
dojo.mixin(pocjs.entities.Item,{none:new pocjs.entities.Item(-1,16761699,"",""),powerGlove:new pocjs.entities.Item(0,16761699,"Power Glove","Smaaaash!!"),pistol:new pocjs.entities.Item(1,15395562,"Pistol","Pew, pew, pew!"),flippers:new pocjs.entities.Item(2,8174591,"Flippers","Splish splash!"),cutters:new pocjs.entities.Item(3,13421772,"Cutters","Snip, snip!"),skates:new pocjs.entities.Item(4,11432191,"Skates","Sharp!"),key:new pocjs.entities.Item(5,16728128,"Key","How did you get this?"),potion:new pocjs.entities.Item(6,
4915015,"Potion","Healthy!")});dojo.provide("pocjs.menu.Menu");dojo.declare("pocjs.menu.Menu",null,{render:function(){},tick:function(){}});dojo.provide("pocjs.menu.AboutMenu");
dojo.declare("pocjs.menu.AboutMenu",pocjs.menu.Menu,{tickDelay:30,render:function(a){a.fill(0,0,160,120,0);a.drawString("About",60,8,pocjs.Art.getCol(16777215));for(var b="Prelude of the Chambered;by Markus Persson.;Made Aug 2011 for the;21'st Ludum Dare compo.;;This game is freeware,;and was made from scratch;in just 48 hours.".split(";"),c=0;c<b.length;c++)a.drawString(b[c],4,28+c*8,pocjs.Art.getCol(10526880));this.tickDelay==0&&a.drawString("-> Continue",40,a.height-16,pocjs.Art.getCol(16777088))},
tick:function(a,b,c,d,j,l){this.tickDelay>0?this.tickDelay--:l&&(pocjs.Sound.click1.play(),a.setMenu(new pocjs.menu.TitleMenu))}});dojo.provide("pocjs.menu.GotLootMenu");
dojo.declare("pocjs.menu.GotLootMenu",pocjs.menu.Menu,{tickDelay:30,item:null,constructor:function(a){this.item=a},render:function(a){var b="You found the "+this.item.name+"!";a.scaleDraw(pocjs.Art.items,3,a.width/2-24,2,this.item.icon*16,0,16,16,pocjs.Art.getCol(this.item.color));a.drawString(b,(a.width-b.length*6)/2+2,50,pocjs.Art.getCol(16777088));b=this.item.description;a.drawString(b,(a.width-b.length*6)/2+2,60,pocjs.Art.getCol(10526880));this.tickDelay==0&&a.drawString("-> Continue",40,a.height-
40,pocjs.Art.getCol(16777088))},tick:function(a,b,c,d,j,l){this.tickDelay>0?this.tickDelay--:l&&a.setMenu(null)}});dojo.provide("pocjs.menu.InstructionsMenu");
dojo.declare("pocjs.menu.InstructionsMenu",pocjs.menu.Menu,{tickDelay:30,render:function(a){a.fill(0,0,160,120,0);a.drawString("Instructions",40,8,pocjs.Art.getCol(16777215));for(var b="Use W,A,S,D to move, and;the arrow keys to turn.;;The 1-8 keys select;items from the inventory;;Space uses items".split(";"),c=0;c<b.length;c++)a.drawString(b[c],4,32+c*8,pocjs.Art.getCol(10526880));this.tickDelay==0&&a.draw("-> Continue",40,a.height-16,pocjs.Art.getCol(16777088))},tick:function(a,b,c,d,j,l){this.tickDelay>
0?this.tickDelay--:l&&(pocjs.Sound.click1.play(),a.setMenu(new pocjs.menu.TitleMenu))}});dojo.provide("pocjs.menu.LoseMenu");
dojo.declare("pocjs.menu.LoseMenu",pocjs.menu.Menu,{tickDelay:30,player:null,constructor:function(a){this.player=a},render:function(a){a.drawPart(pocjs.Art.logo,0,10,0,39,160,23,pocjs.Art.getCol(16777215));var b=this.player.time/60<<0,c=b/60<<0;b%=60;c+=":";b<10&&(c+="0");c+=b;a.drawString("Trinkets: "+this.player.loot+"/12",40,45,pocjs.Art.getCol(9474192));a.drawString("Time: "+c,40,55,pocjs.Art.getCol(9474192));this.tickDelay==0&&a.drawString("-> Continue",40,a.height-40,pocjs.Art.getCol(16777088))},
tick:function(a,b,c,d,j,l){this.tickDelay>0?this.tickDelay--:l&&(pocjs.Sound.click1.play(),a.setMenu(new pocjs.menu.TitleMenu))}});dojo.provide("pocjs.menu.PauseMenu");
dojo.declare("pocjs.menu.PauseMenu",pocjs.menu.Menu,{options:["Abort game","Continue"],selected:1,render:function(a){a.drawPart(pocjs.Art.logo,0,8,0,0,160,36,pocjs.Art.getCol(16777215));for(var b=0;b<this.options.length;b++){var c=this.options[b],d=9474192;this.selected==b&&(c="-> "+c,d=16777088);a.drawString(c,40,60+b*10,pocjs.Art.getCol(d))}},tick:function(a,b,c,d,j,l){(b||c)&&pocjs.Sound.click2.play();b&&this.selected--;c&&this.selected++;if(this.selected<0)sthis.elected=0;if(this.selected>=this.options.length)this.selected=
this.options.length-1;l&&(pocjs.Sound.click1.play(),this.selected==0&&a.setMenu(new pocjs.menu.TitleMenu),this.selected==1&&a.setMenu(null))}});dojo.provide("pocjs.menu.TitleMenu");
dojo.declare("pocjs.menu.TitleMenu",pocjs.menu.Menu,{options:["New game","Instructions","About"],selected:0,firstTick:!0,render:function(a){a.fill(0,0,160,120,0);a.drawPart(pocjs.Art.logo,0,8,0,0,160,36,pocjs.Art.getCol(16777215));for(var b=0;b<this.options.length;b++){var c=this.options[b],d=9474192;this.selected==b&&(c="-> "+c,d=16777088);a.drawString(c,40,60+b*10,pocjs.Art.getCol(d))}a.drawString("Copyright (C) 2011 Mojang",5,111,pocjs.Art.getCol(3158064))},tick:function(a,b,c,d,j,l){if(this.firstTick)this.firstTick=
!1,pocjs.Sound.altar.play();(b||c)&&pocjs.Sound.click2.play();b&&this.selected--;c&&this.selected++;if(this.selected<0)this.selected=0;if(this.selected>=this.options.length)this.selected=this.options.length-1;l&&(pocjs.Sound.click1.play(),this.selected==0&&(a.setMenu(null),a.newGame()),this.selected==1&&a.setMenu(new pocjs.menu.InstructionsMenu),this.selected==2&&a.setMenu(new pocjs.menu.AboutMenu))}});dojo.provide("pocjs.menu.WinMenu");
dojo.declare("pocjs.menu.WinMenu",pocjs.menu.Menu,{tickDelay:30,player:null,constructor:function(a){this.player=a},render:function(a){a.drawPart(pocjs.Art.logo,0,10,0,65,160,23,pocjs.Art.getCol(16777215));var b=this.player.time/60<<0,c=b/60<<0;b%=60;c+=":";b<10&&(c+="0");c+=b;a.drawString("Trinkets: "+this.player.loot+"/12",40,45,pocjs.Art.getCol(9474192));a.drawString("Time: "+c,40,55,pocjs.Art.getCol(9474192));this.tickDelay==0&&a.drawString("-> Continue",40,a.height-40,pocjs.Art.getCol(16777088))},
tick:function(a,b,c,d,j,l){this.tickDelay>0?this.tickDelay--:l&&(pocjs.Sound.click1.play(),a.setMenu(new pocjs.menu.TitleMenu))}});dojo.provide("pocjs.entities.Entity");
dojo.declare("pocjs.entities.Entity",null,{sprites:null,x:0,z:0,rot:0,xa:0,za:0,rota:0,r:0.4,level:null,xTileO:-1,zTileO:-1,flying:!1,removed:!1,constructor:function(){this.sprites=[]},updatePos:function(){var a=this.x+0.5<<0,b=this.z+0.5<<0;if(a!=this.xTileO||b!=this.zTileO)this.level.getBlock(this.xTileO,this.zTileO).removeEntity(this),this.xTileO=a,this.zTileO=b,this.removed||this.level.getBlock(this.xTileO,this.zTileO).addEntity(this)},isRemoved:function(){return this.removed},remove:function(){this.level.getBlock(this.xTileO,
this.zTileO).removeEntity(this);this.removed=!0},move:function(){for(var a=Math.abs(this.xa*100)+1<<0,b=a;b>0;b--){var c=this.xa;if(this.isFree(this.x+c*b/a,this.z)){this.x+=c*b/a;break}else this.xa=0}for(b=a=Math.abs(this.za*100)+1<<0;b>0;b--)if(c=this.za,this.isFree(this.x,this.z+c*b/a)){this.z+=c*b/a;break}else this.za=0},isFree:function(a,b){var c=Math.floor(a+0.5-this.r),d=Math.floor(a+0.5+this.r),j=Math.floor(b+0.5-this.r),l=Math.floor(b+0.5+this.r);if(this.level.getBlock(c,j).blocks(this))return!1;
if(this.level.getBlock(d,j).blocks(this))return!1;if(this.level.getBlock(c,l).blocks(this))return!1;if(this.level.getBlock(d,l).blocks(this))return!1;c=Math.floor(a+0.5);d=Math.floor(b+0.5);for(j=d-2;j<=d+2;j++)for(l=c-2;l<=c+2;l++)for(var m=this.level.getBlock(l,j).entities,k=0;k<m.length;k++){var h=m[k];if(h!=this&&h.blocks(this,a,b,this.r))return h.collide(this),this.collide(h),!1}return!0},collide:function(){},blocks:function(a,b,c,d){return a instanceof pocjs.entities.Bullet&&a.owner==this?!1:
this.x+this.r<=b-d?!1:this.x-this.r>=b+d?!1:this.z+this.r<=c-d?!1:this.z-this.r>=c+d?!1:!0},contains:function(a,b){return this.x+this.r<=a?!1:this.x-this.r>=a?!1:this.z+this.r<=b?!1:this.z-this.r>=b?!1:!0},isInside:function(a,b,c,d){return this.x+this.r<=a?!1:this.x-this.r>=c?!1:this.z+this.r<=b?!1:this.z-this.r>=d?!1:!0},use:function(){return!1},tick:function(){}});dojo.provide("pocjs.entities.Player");
dojo.declare("pocjs.entities.Player",pocjs.entities.Entity,{bob:null,bobPhase:null,turnBob:null,selectedSlot:0,itemUseTime:0,y:null,ya:null,hurtTime:0,health:20,keys:0,loot:0,dead:!1,deadTime:0,ammo:0,potions:0,lastBlock:null,items:null,constructor:function(){this.r=0.3;this.items=Array(8);for(var a=0;a<this.items.length;a++)this.items[a]=pocjs.entities.Item.none},sliding:!1,time:null,tick:function(a,b,c,d,j,l){this.dead?(a=b=c=d=j=l=!1,this.deadTime++,this.deadTime>120&&this.level.lose()):this.time++;
this.itemUseTime>0&&this.itemUseTime--;this.hurtTime>0&&this.hurtTime--;var m=this.level.getBlock(this.x+0.5<<0,this.z+0.5<<0),k=m.getFloorHeight(this);m instanceof pocjs.level.block.WaterBlock&&!(this.lastBlock instanceof pocjs.level.block.WaterBlock)&&pocjs.Sound.splash.play();this.lastBlock=m;this.dead&&(k=-0.6);if(k>this.y)this.y+=(k-this.y)*0.2,this.ya=0;else if(this.ya-=0.01,this.y+=this.ya,this.y<k)this.y=k,this.ya=0;k=0.03*m.getWalkSpeed(this);j&&(this.rota+=0.05);l&&(this.rota-=0.05);l=j=
0;a&&l--;b&&l++;c&&j--;d&&j++;a=j*j+l*l;a=a>0?Math.sqrt(a):1;j/=a;l/=a;this.bob*=0.6;this.turnBob*=0.8;this.turnBob+=this.rota;this.bob+=Math.sqrt(j*j+l*l);this.bobPhase+=Math.sqrt(j*j+l*l)*m.getWalkSpeed(this);a=this.sliding;this.sliding=!1;m instanceof pocjs.level.block.IceBlock&&this.getSelectedItem()!=pocjs.entities.Item.skates?(this.xa*this.xa>this.za*this.za?(this.sliding=!0,this.za=0,this.xa=this.xa>0?0.08:-0.08,this.z+=(Math.floor(this.z+0.5)-this.z)*0.2):this.xa*this.xa<this.za*this.za?(this.sliding=
!0,this.xa=0,this.za=this.za>0?0.08:-0.08,this.x+=(Math.floor(this.x+0.5)-this.x)*0.2):(this.xa-=(j*Math.cos(this.rot)+l*Math.sin(this.rot))*0.1,this.za-=(l*Math.cos(this.rot)-j*Math.sin(this.rot))*0.1),!a&&this.sliding&&pocjs.Sound.slide.play()):(this.xa-=(j*Math.cos(this.rot)+l*Math.sin(this.rot))*k,this.za-=(l*Math.cos(this.rot)-j*Math.sin(this.rot))*k);this.move();m=m.getFriction(this);this.xa*=m;this.za*=m;this.rot+=this.rota;this.rota*=0.4},activate:function(){if(!this.dead&&!(this.itemUseTime>
0)){var a=this.items[this.selectedSlot];if(a==pocjs.entities.Item.pistol){if(this.ammo>0)pocjs.Sound.shoot.play(),this.itemUseTime=10,this.level.addEntity(new pocjs.entities.Bullet(this,this.x,this.z,this.rot,1,0,16777215)),this.ammo--}else if(a==pocjs.entities.Item.potion){if(this.potions>0&&this.health<20){pocjs.Sound.potion.play();this.itemUseTime=20;this.health+=5+(Math.random()*6<<0);if(this.health>20)this.health=20;this.potions--}}else{if(a==pocjs.entities.Item.key)this.itemUseTime=10;if(a==
pocjs.entities.Item.powerGlove)this.itemUseTime=10;if(a==pocjs.entities.Item.cutters)this.itemUseTime=10;for(var a=2*Math.sin(this.rot),b=2*Math.cos(this.rot),c=this.x+0.5<<0,d=this.z+0.5<<0,j=[],l=d-3;l<=d+3;l++)for(var m=c-3;m<=c+3;m++)for(var k=this.level.getBlock(m,l).entities,h=0;h<k.length;h++){var e=k[h];e!=this&&j.push(e)}for(h=0;h<100;h++){c=this.x+a*h/100;d=this.z+b*h/100;for(l=0;l<j.length;l++)if(e=j[l],e.contains(c,d)&&e.use(this,this.items[this.selectedSlot]))return;if(this.level.getBlock(c+
0.5<<0,d+0.5<<0).use(this.level,this.items[this.selectedSlot]))break}}}},blocks:function(a,b,c,d){return a instanceof pocjs.entities.Bullet?!1:this.inherited(arguments)},getSelectedItem:function(){return this.items[this.selectedSlot]},addLoot:function(a){a==pocjs.entities.Item.pistol&&(this.ammo+=20);a==pocjs.entities.Item.potion&&(this.potions+=1);for(var b=0;b<this.items.length;b++)if(this.items[b]==a){this.level.showLootScreen(a);return}for(b=0;b<this.items.length;b++)if(this.items[b]==pocjs.entities.Item.none){this.items[b]=
a;this.selectedSlot=b;this.itemUseTime=0;this.level.showLootScreen(a);break}},hurt:function(a,b){if(!(this.hurtTime>0||this.dead)){this.hurtTime=40;this.health-=b;if(this.health<=0)this.health=0,pocjs.Sound.death.play(),this.dead=!0;pocjs.Sound.hurt.play();var c=a.x-this.x,d=a.z-this.z,j=Math.sqrt(c*c+d*d);this.xa-=c/j*0.1;this.za-=d/j*0.1;this.rota+=(Math.random()-0.5)*0.2}},collide:function(a){a instanceof pocjs.entities.Bullet&&a.owner.declaredClass!=this.declaredClass&&!(this.hurtTime>0)&&(a.remove(),
this.hurt(a,1))},win:function(){this.level.win()}});dojo.provide("pocjs.entities.EnemyEntity");
dojo.declare("pocjs.entities.EnemyEntity",pocjs.entities.Entity,{sprite:null,rot:0,rota:0,defaultTex:null,defaultColor:null,hurtTime:0,animTime:0,health:3,spinSpeed:0.1,runSpeed:1,constructor:function(a,b,c,d){this.inherited(arguments);this.x=a;this.z=b;this.defaultColor=d;this.defaultTex=c;this.sprite=new pocjs.gui.Sprite(0,0,0,32,d);this.sprites.push(this.sprite);this.r=0.3},haveNextGaussian:!1,nextNextGaussian:null,nextGaussian:function(){if(this.haveNextNextGaussian)return this.haveNextNextGaussian=
!1,this.nextNextGaussian;else{var a,b,c;do a=2*Math.random()-1,b=2*Math.random()-1,c=a*a+b*b;while(c>=1||c==0);c=Math.sqrt(-2*Math.log(c)/c);this.nextNextGaussian=b*c;this.haveNextNextGaussian=!0;return a*c}},tick:function(){if(this.hurtTime>0&&(this.hurtTime--,this.hurtTime==0))this.sprite.col=this.defaultColor;this.animTime++;this.sprite.tex=this.defaultTex+(this.animTime/10<<0)%2;this.move();if(this.xa==0||this.za==0)this.rota+=this.nextGaussian()*Math.random()*0.3;this.rota+=this.nextGaussian()*
Math.random()*this.spinSpeed;this.rot+=this.rota;this.rota*=0.8;this.xa*=0.8;this.za*=0.8;this.xa+=Math.sin(this.rot)*0.0040*this.runSpeed;this.za+=Math.cos(this.rot)*0.0040*this.runSpeed},use:function(a,b){if(this.hurtTime>0)return!1;if(b!=pocjs.entities.Item.powerGlove)return!1;this.hurt(Math.sin(a.rot),Math.cos(a.rot));return!0},hurt:function(a,b){this.sprite.col=pocjs.Art.getCol(16711680);this.hurtTime=15;var c=Math.sqrt(a*a+b*b);this.xa+=a/c*0.2;this.za+=b/c*0.2;pocjs.Sound.hurt2.play();this.health--;
if(this.health<=0){var c=this.x+0.5<<0,d=this.z+0.5<<0;this.level.getBlock(c,d).addSprite(new pocjs.gui.PoofSprite(this.x-c,0,this.z-d));this.die();this.remove();pocjs.Sound.kill.play()}},die:function(){},collide:function(a){if(a instanceof pocjs.entities.Bullet){if(a.owner.declaredClass==this.declaredClass)return;if(this.hurtTime>0)return;a.remove();this.hurt(a.xa,a.za)}a instanceof pocjs.entities.Player&&a.hurt(this,1)}});dojo.provide("pocjs.entities.BatBossEntity");
dojo.declare("pocjs.entities.BatBossEntity",pocjs.entities.EnemyEntity,{"-chains-":{constructor:"manual"},constructor:function(a,b){this.inherited(arguments,[a,b,32,pocjs.Art.getCol(16776960)]);this.x=a;this.z=b;this.health=5;this.r=0.3;this.flying=!0},die:function(){pocjs.Sound.bosskill.play();this.level.addEntity(new pocjs.entities.KeyEntity(this.x,this.z))},tick:function(){this.inherited(arguments);if(Math.random()*20<1){var a=this.x+(Math.random()-0.5)*2,b=this.z+(Math.random()-0.5)*2,c=new pocjs.entities.BatEntity(a,
b);c.level=this.level;c.isFree(a,b)&&this.level.addEntity(c)}}});dojo.provide("pocjs.entities.BatEntity");dojo.declare("pocjs.entities.BatEntity",pocjs.entities.EnemyEntity,{"-chains-":{constructor:"manual"},constructor:function(a,b){this.inherited(arguments,[a,b,32,pocjs.Art.getCol(8545902)]);this.x=a;this.z=b;this.health=2;this.r=0.3;this.flying=!0}});dojo.provide("pocjs.entities.BossOgre");
dojo.declare("pocjs.entities.BossOgre",pocjs.entities.EnemyEntity,{shootDelay:null,shootPhase:null,"-chains-":{constructor:"manual"},constructor:function(a,b){this.inherited(arguments,[a,b,34,pocjs.Art.getCol(16776960)]);this.x=a;this.z=b;this.health=10;this.r=0.4;this.spinSpeed=0.05},die:function(){pocjs.Sound.bosskill.play();this.level.addEntity(new pocjs.entities.KeyEntity(this.x,this.z))},tick:function(){this.inherited(arguments);if(this.shootDelay>0)this.shootDelay--;else{this.shootDelay=5;for(var a=
0;a<4;a++)this.level.addEntity(new pocjs.entities.Bullet(this,this.x,this.z,Math.PI/2*(a+this.shootPhase/10%2*0.5),0.4,1,this.defaultColor));this.shootPhase++;if(this.shootPhase%10==0)this.shootDelay=40}}});dojo.provide("pocjs.entities.BoulderEntity");
dojo.declare("pocjs.entities.BoulderEntity",pocjs.entities.Entity,{COLOR:pocjs.Art.getCol(11510419),sprite:null,rollDist:0,constructor:function(a,b){this.x=a;this.z=b;this.sprite=new pocjs.gui.Sprite(0,0,0,16,this.COLOR);this.sprites.push(this.sprite)},tick:function(){this.rollDist+=Math.sqrt(this.xa*this.xa+this.za*this.za);this.sprite.tex=8+(this.rollDist*4&1);var a=this.xa,b=this.za;this.move();if(this.xa==0&&a!=0)this.xa=-a*0.3;if(this.za==0&&b!=0)this.za=-b*0.3;this.xa*=0.98;this.za*=0.98;if(this.xa*
this.xa+this.za*this.za<1.0E-4)this.xa=this.za=0},use:function(a,b){if(b!=pocjs.entities.Item.powerGlove)return!1;pocjs.Sound.roll.play();this.xa+=Math.sin(a.rot)*0.1;this.za+=Math.cos(a.rot)*0.1;return!0}});dojo.provide("pocjs.entities.Bullet");
dojo.declare("pocjs.entities.Bullet",pocjs.entities.Entity,{owner:null,constructor:function(a,b,c,d,j,l,m){this.r=0.01;this.owner=a;this.xa=Math.sin(d)*0.2*j;this.za=Math.cos(d)*0.2*j;this.x=b-this.za/2;this.z=c+this.xa/2;this.sprites.push(new pocjs.gui.Sprite(0,0,0,24+l,pocjs.Art.getCol(m)));this.flying=!0},tick:function(){var a=this.xa,b=this.za;this.move();(this.xa==0&&this.za==0||this.xa!=a||this.za!=b)&&this.remove()},blocks:function(a,b,c,d){return a instanceof pocjs.entities.Bullet?!1:a===
this.owner?!1:this.inherited(arguments)},collide:function(){}});dojo.provide("pocjs.entities.EyeBossEntity");dojo.declare("pocjs.entities.EyeBossEntity",pocjs.entities.EnemyEntity,{"-chains-":{constructor:"manual"},constructor:function(a,b){this.inherited(arguments,[a,b,36,pocjs.Art.getCol(16776960)]);this.x=a;this.z=b;this.health=10;this.r=0.3;this.runSpeed=4;this.spinSpeed*=1.5;this.flying=!0},die:function(){pocjs.Sound.bosskill.play();this.level.addEntity(new pocjs.entities.KeyEntity(this.x,this.z))}});
dojo.provide("pocjs.entities.EyeEntity");dojo.declare("pocjs.entities.EyeEntity",pocjs.entities.EnemyEntity,{"-chains-":{constructor:"manual"},constructor:function(a,b){this.inherited(arguments,[a,b,36,pocjs.Art.getCol(8711423)]);this.x=a;this.z=b;this.health=4;this.r=0.3;this.runSpeed=2;this.spinSpeed*=1.5;this.flying=!0}});dojo.provide("pocjs.entities.GhostBossEntity");
dojo.declare("pocjs.entities.GhostBossEntity",pocjs.entities.EnemyEntity,{rotatePos:0,shootDelay:0,"-chains-":{constructor:"manual"},constructor:function(a,b){this.inherited(arguments,[a,b,38,pocjs.Art.getCol(16776960)]);this.x=a;this.z=b;this.health=10;this.flying=!0},tick:function(){this.animTime++;this.sprite.tex=this.defaultTex+(this.animTime/10|0)%2;var a=this.level.player.x+Math.sin(this.rotatePos)*2-this.x,b=this.level.player.z+Math.cos(this.rotatePos)*2-this.z,c=a*a+b*b;c<1?this.rotatePos+=
0.04:this.rotatePos=this.level.player.rot;if(c<16)if(c=Math.sqrt(c),a/=c,b/=c,this.xa+=a*0.0060,this.za+=b*0.0060,this.shootDelay>0)this.shootDelay--;else if((Math.random()*10|0)==0)this.shootDelay=10,this.level.addEntity(new pocjs.entities.Bullet(this,this.x,this.z,Math.atan2(this.level.player.x-this.x,this.level.player.z-this.z),0.2,1,this.defaultColor));this.move();this.xa*=0.9;this.za*=0.9},hurt:function(){},move:function(){this.x+=this.xa;this.z+=this.za}});dojo.provide("pocjs.entities.GhostEntity");
dojo.declare("pocjs.entities.GhostEntity",pocjs.entities.EnemyEntity,{rotatePos:0,"-chains-":{constructor:"manual"},constructor:function(a,b){this.inherited(arguments,[a,b,38,pocjs.Art.getCol(16777215)]);this.x=a;this.z=b;this.health=4;this.r=0.3;this.flying=!0},tick:function(){this.animTime++;this.sprite.tex=this.defaultTex+(this.animTime/10<<0)%2;var a=this.level.player.x+Math.sin(this.rotatePos)-this.x,b=this.level.player.z+Math.cos(this.rotatePos)-this.z,c=a*a+b*b;if(c<16)c<1?this.rotatePos+=
0.04:(this.rotatePos=this.level.player.rot,this.xa+=(Math.random()-0.5)*0.02,this.za+=(Math.random()-0.5)*0.02),c=Math.sqrt(c),a/=c,b/=c,this.xa+=a*0.0040,this.za+=b*0.0040;this.move();this.xa*=0.9;this.za*=0.9},hurt:function(){},move:function(){this.x+=this.xa;this.z+=this.za}});dojo.provide("pocjs.entities.KeyEntity");
dojo.declare("pocjs.entities.KeyEntity",pocjs.entities.Entity,{COLOR:pocjs.Art.getCol(65535),sprite:null,y:null,ya:null,constructor:function(a,b){this.x=a;this.z=b;this.y=0.5;this.ya=0.025;this.sprite=new pocjs.gui.Sprite(0,0,0,19,this.COLOR);this.sprites.push(this.sprite)},tick:function(){this.move();this.y+=this.ya;if(this.y<0)this.y=0;this.ya-=0.0050;this.sprite.y=this.y},collide:function(a){a instanceof pocjs.entities.Player&&(pocjs.Sound.key.play(),a.keys++,this.remove())}});dojo.provide("pocjs.entities.OgreEntity");
dojo.declare("pocjs.entities.OgreEntity",pocjs.entities.EnemyEntity,{shootDelay:null,"-chains-":{constructor:"manual"},constructor:function(a,b){this.inherited(arguments,[a,b,34,pocjs.Art.getCol(8562721)]);this.x=a;this.z=b;this.health=6;this.r=0.4;this.spinSpeed=0.05},hurt:function(a,b){this.inherited(arguments);this.shootDelay=50},tick:function(){this.inherited(arguments);if(this.shootDelay>0)this.shootDelay--;else if(Math.random()*40<<0==0)this.shootDelay=40,this.level.addEntity(new pocjs.entities.Bullet(this,
this.x,this.z,Math.atan2(this.level.player.x-this.x,this.level.player.z-this.z),0.3,1,this.defaultColor))}});dojo.provide("pocjs.level.block.Block");
dojo.declare("pocjs.level.block.Block",null,{blocksMotion:!1,solidRender:!1,messages:null,sprites:null,entities:null,tex:-1,col:-1,floorCol:-1,ceilCol:-1,floorTex:-1,ceilTex:-1,level:null,x:0,y:0,id:0,constructor:function(){this.messages=[];this.sprites=[];this.entities=[]},addSprite:function(a){this.sprites.push(a)},use:function(){return!1},tick:function(){this.sprites=this.sprites.filter(function(a){a.tick();return a.removed?!1:!0})},removeEntity:function(a){this.entities.splice(this.entities.indexOf(a),
1)},addEntity:function(a){this.entities.push(a)},blocks:function(){return this.blocksMotion},decorate:function(){},getFloorHeight:function(){return 0},getWalkSpeed:function(){return 1},getFriction:function(){return 0.6},trigger:function(){}});dojo.provide("pocjs.level.block.SolidBlock");dojo.declare("pocjs.level.block.SolidBlock",pocjs.level.block.Block,{constructor:function(){this.blocksMotion=this.solidRender=!0}});dojo.extend(pocjs.level.block.Block,{solidWall:new pocjs.level.block.SolidBlock});
dojo.provide("pocjs.level.block.DoorBlock");
dojo.declare("pocjs.level.block.DoorBlock",pocjs.level.block.SolidBlock,{open:!1,openness:0,constructor:function(){this.tex=4;this.solidRender=!1},use:function(){(this.open=!this.open)?pocjs.Sound.click1.play():pocjs.Sound.click2.play();return!0},tick:function(){this.inherited(arguments);this.open?this.openness+=0.2:this.openness-=0.2;if(this.openness<0)this.openness=0;if(this.openness>1)this.openness=1;this.openness<0.875&&!this.open&&!this.blocksMotion&&this.level.containsBlockingEntity(this.x-
0.5,this.y-0.5,this.x+0.5,this.y+0.5)?this.openness=0.875:this.blocksMotion=this.openness<0.875},blocks:function(a){var b="Player Bullet OgreEntity".split(" ").some(function(b){return a instanceof pocjs.entities[b]});return this.openness>=0.875&&b?this.blocksMotion:!0}});dojo.provide("pocjs.level.block.LockedDoorBlock");dojo.declare("pocjs.level.block.LockedDoorBlock",pocjs.level.block.DoorBlock,{constructor:function(){this.tex=5},use:function(){return!1},trigger:function(a){this.open=a}});dojo.provide("pocjs.level.block.AltarBlock");
dojo.declare("pocjs.level.block.AltarBlock",pocjs.level.block.Block,{filled:!1,sprite:null,constructor:function(){this.blocksMotion=!0;this.sprite=new pocjs.gui.Sprite(0,0,0,20,pocjs.Art.getCol(14876644));this.addSprite(this.sprite)},addEntity:function(a){this.inherited(arguments);if(!this.filled&&(a instanceof pocjs.entities.GhostEntity||a instanceof pocjs.entities.GhostBossEntity)){a.remove();this.filled=!0;this.blocksMotion=!1;this.sprite.removed=!0;for(var b=0;b<8;b++){var c=new pocjs.gui.RubbleSprite;
c.col=this.sprite.col;this.addSprite(c)}a instanceof pocjs.entities.GhostBossEntity?(this.level.addEntity(new pocjs.entities.KeyEntity(this.x,this.y)),pocjs.Sound.bosskill.play()):pocjs.Sound.altar.play()}},blocks:function(){return this.blocksMotion}});dojo.provide("pocjs.level.block.BarsBlock");
dojo.declare("pocjs.level.block.BarsBlock",pocjs.level.block.Block,{sprite:null,open:!1,constructor:function(){this.sprite=new pocjs.gui.Sprite(0,0,0,0,2105376);this.addSprite(this.sprite);this.blocksMotion=!0},use:function(a,b){if(this.open)return!1;if(b==pocjs.entities.Item.cutters)pocjs.Sound.cut.play(),this.sprite.tex=1,this.open=!0;return!0},blocks:function(a){return this.open&&a instanceof pocjs.entities.Player?!1:this.open&&a instanceof pocjs.entities.Bullet?!1:this.blocksMotion}});dojo.provide("pocjs.level.block.ChestBlock");
dojo.declare("pocjs.level.block.ChestBlock",pocjs.level.block.Block,{open:!1,chestSprite:null,constructor:function(){this.tex=1;this.blocksMotion=!0;this.chestSprite=new pocjs.gui.Sprite(0,0,0,16,pocjs.Art.getCol(16776960));this.addSprite(this.chestSprite)},use:function(a){if(this.open)return!1;this.chestSprite.tex++;this.open=!0;a.getLoot(this.id);pocjs.Sound.treasure.play();return!0}});dojo.provide("pocjs.level.block.FinalUnlockBlock");
dojo.declare("pocjs.level.block.FinalUnlockBlock",pocjs.level.block.SolidBlock,{pressed:!1,constructor:function(){this.tex=11},use:function(a){if(this.pressed)return!1;if(a.player.keys<4)return!1;pocjs.Sound.click1.play();this.pressed=!0;a.trigger(this.id,!0);return!0}});dojo.provide("pocjs.level.block.IceBlock");
dojo.declare("pocjs.level.block.IceBlock",pocjs.level.block.Block,{constructor:function(){this.blocksMotion=!1;this.floorTex=16},tick:function(){this.inherited(arguments);this.floorCol=pocjs.Art.getCol(8421631)},getWalkSpeed:function(a){return a.getSelectedItem()==pocjs.entities.Item.skates?0.05:1.4},getFriction:function(a){return a.getSelectedItem()==pocjs.entities.Item.skates?0.98:1},blocks:function(a){return a instanceof pocjs.entities.Player?!1:a instanceof pocjs.entities.Bullet?!1:a instanceof
pocjs.entities.EyeBossEntity?!1:a instanceof pocjs.entities.EyeEntity?!1:!0}});dojo.provide("pocjs.level.block.LadderBlock");
dojo.declare("pocjs.level.block.LadderBlock",pocjs.level.block.Block,{LADDER_COLOR:14388819,wait:null,constructor:function(a){a?(this.floorTex=1,this.addSprite(new pocjs.gui.Sprite(0,0,0,11,pocjs.Art.getCol(this.LADDER_COLOR)))):(this.ceilTex=1,this.addSprite(new pocjs.gui.Sprite(0,0,0,12,pocjs.Art.getCol(this.LADDER_COLOR))))},removeEntity:function(a){this.inherited(arguments);if(a instanceof pocjs.entities.Player)this.wait=!1},addEntity:function(a){this.inherited(arguments);!this.wait&&a instanceof
pocjs.entities.Player&&(this.level.switchLevel(this.id),pocjs.Sound.ladder.play())}});dojo.provide("pocjs.level.block.LootBlock");
dojo.declare("pocjs.level.block.LootBlock",pocjs.level.block.Block,{taken:!1,sprite:null,constructor:function(){this.sprite=new pocjs.gui.Sprite(0,0,0,18,pocjs.Art.getCol(16777088));this.addSprite(this.sprite);this.blocksMotion=!0},addEntity:function(a){this.inherited(arguments,[a]);if(!this.taken&&a instanceof pocjs.entities.Player)this.taken=this.sprite.removed=!0,this.blocksMotion=!1,a.loot++,pocjs.Sound.pickup.play()},blocks:function(a){return a instanceof pocjs.entities.Player?!1:this.blocksMotion}});
dojo.provide("pocjs.level.block.PitBlock");
dojo.declare("pocjs.level.block.PitBlock",pocjs.level.block.Block,{filled:!1,constructor:function(){this.floorTex=1;this.blocksMotion=!0},addEntity:function(a){this.inherited(arguments);if(!this.filled&&a instanceof pocjs.entities.BoulderEntity)a.remove(),this.filled=!0,this.blocksMotion=!1,this.addSprite(new pocjs.gui.Sprite(0,0,0,10,pocjs.entities.BoulderEntity.prototype.COLOR)),pocjs.Sound.thud.play()},blocks:function(a){return a instanceof pocjs.entities.BoulderEntity?!1:this.blocksMotion}});
dojo.provide("pocjs.level.block.PressurePlateBlock");
dojo.declare("pocjs.level.block.PressurePlateBlock",pocjs.level.block.Block,{pressed:!1,constructor:function(){this.floorTex=2},tick:function(){this.inherited(arguments);var a=this.level.containsBlockingNonFlyingEntity(this.x-0.2,this.y-0.2,this.x+0.2,this.y+0.2);if(a!=this.pressed)this.floorTex=(this.pressed=a)?3:2,this.level.trigger(this.id,this.pressed),this.pressed?pocjs.Sound.click1.play():pocjs.Sound.click2.play()},getFloorHeight:function(){return this.pressed?-0.02:0.02}});dojo.provide("pocjs.level.block.SpiritWallBlock");
dojo.declare("pocjs.level.block.SpiritWallBlock",pocjs.level.block.Block,{constructor:function(){this.ceilTex=this.floorTex=7;this.blocksMotion=!0;for(var a=0;a<6;a++){var b=Math.random()-0.5,c=(Math.random()-0.7)*0.3,d=Math.random()-0.5;this.addSprite(new pocjs.gui.Sprite(b,c,d,38+Math.random()*2<<0,pocjs.Art.getCol(2105376)))}},blocks:function(a){return a instanceof pocjs.entities.Bullet?!1:this.inherited(arguments)}});dojo.provide("pocjs.level.block.SwitchBlock");
dojo.declare("pocjs.level.block.SwitchBlock",pocjs.level.block.SolidBlock,{pressed:!1,constructor:function(){this.tex=2},use:function(a){this.tex=(this.pressed=!this.pressed)?3:2;a.trigger(this.id,this.pressed);this.pressed?pocjs.Sound.click1.play():pocjs.Sound.click2.play();return!0}});dojo.provide("pocjs.level.block.TorchBlock");
dojo.declare("pocjs.level.block.TorchBlock",pocjs.level.block.Block,{torchSprite:null,constructor:function(){this.torchSprite=new pocjs.gui.Sprite(0,0,0,3,pocjs.Art.getCol(16776960));this.sprites.push(this.torchSprite)},decorate:function(a,b,c){for(var d,j=0;j<1E3;j++){var l=Math.random()*4<<0;d=a.getBlock(b-1,c);if(l==0&&d.solidRender&&!(d instanceof pocjs.level.block.VanishBlock)){this.torchSprite.x-=0.4;break}d=a.getBlock(b,c-1);if(l==1&&d.solidRender&&!(d instanceof pocjs.level.block.VanishBlock)){this.torchSprite.z-=
0.4;break}d=a.getBlock(b+1,c);if(l==2&&d.solidRender&&!(d instanceof pocjs.level.block.VanishBlock)){this.torchSprite.x+=0.4;break}d=a.getBlock(b,c+1);if(l==3&&d.solidRender&&!(d instanceof pocjs.level.block.VanishBlock)){this.torchSprite.z+=0.4;break}}},tick:function(){this.inherited(arguments);if(Math.random()*4<<0==0)this.torchSprite.tex=3+(Math.random()*2<<0)}});dojo.provide("pocjs.level.block.VanishBlock");
dojo.declare("pocjs.level.block.VanishBlock",pocjs.level.block.SolidBlock,{gone:!1,constructor:function(){this.tex=1},use:function(){if(this.gone)return!1;this.gone=!0;this.solidRender=this.blocksMotion=!1;pocjs.Sound.crumble.play();for(var a=0;a<32;a++){var b=new pocjs.gui.RubbleSprite;b.col=this.col;this.addSprite(b)}return!0}});dojo.provide("pocjs.level.block.WaterBlock");
dojo.declare("pocjs.level.block.WaterBlock",pocjs.level.block.Block,{steps:0,constructor:function(){this.blocksMotion=!0},tick:function(){this.inherited(arguments);this.steps--;if(this.steps<=0)this.floorTex=8+Math.random()*3<<0,this.floorCol=pocjs.Art.getCol(255),this.steps=16},blocks:function(a){return a instanceof pocjs.entities.Player&&a.getSelectedItem()==pocjs.entities.Item.flippers?!1:a instanceof pocjs.entities.Bullet?!1:this.blocksMotion},getFloorHeight:function(){return-0.5},getWalkSpeed:function(){return 0.4}});
dojo.provide("pocjs.level.block.WinBlock");dojo.declare("pocjs.level.block.WinBlock",pocjs.level.block.Block,{addEntity:function(a){this.inherited(arguments);a instanceof pocjs.entities.Player&&a.win()}});dojo.provide("pocjs.level.Level");
dojo.declare("pocjs.level.Level",null,{blocks:null,width:null,height:null,xSpawn:null,ySpawn:null,wallCol:11783906,floorCol:10264731,ceilCol:10264731,wallTex:0,floorTex:0,ceilTex:0,entities:null,game:null,name:"",player:null,init:function(a,b,c,d,j){this.game=a;this.player=a.player;this.solidWall=new pocjs.level.block.SolidBlock;this.solidWall.col=pocjs.Art.getCol(this.wallCol);this.solidWall.tex=pocjs.Art.getCol(this.wallTex);this.width=c;this.height=d;this.blocks=Array(c*d<<0);this.entities=[];
for(a=0;a<d;a++)for(b=0;b<c;b++){var l=j[b+a*c]&16777215,m=255-(j[b+a*c]>>24&255),l=this.getNewBlock(b,a,l);l.id=m;if(l.tex==-1)l.tex=this.wallTex;if(l.floorTex==-1)l.floorTex=this.floorTex;if(l.ceilTex==-1)l.ceilTex=this.ceilTex;if(l.col==-1)l.col=pocjs.Art.getCol(this.wallCol);if(l.floorCol==-1)l.floorCol=pocjs.Art.getCol(this.floorCol);if(l.ceilCol==-1)l.ceilCol=pocjs.Art.getCol(this.ceilCol);l.level=this;l.x=b;l.y=a;this.blocks[b+a*c]=l}for(a=0;a<d;a++)for(b=0;b<c;b++)l=j[b+a*c]&16777215,this.decorateBlock(b,
a,this.blocks[b+a*c],l)},addEntity:function(a){this.entities.push(a);a.level=this;a.updatePos()},removeEntityImmediately:function(a){var b=this.entities.indexOf(a);if(b<0)throw"element not found";this.entities.slice(b,1);this.getBlock(a.xTileO,a.zTileO).removeEntity(a)},decorateBlock:function(a,b,c,d){c.decorate(this,a,b);if(d==16776960)this.xSpawn=a,this.ySpawn=b;d==11162880&&this.addEntity(new pocjs.entities.BoulderEntity(a,b));d==16711680&&this.addEntity(new pocjs.entities.BatEntity(a,b));d==16711681&&
this.addEntity(new pocjs.entities.BatBossEntity(a,b));d==16711682&&this.addEntity(new pocjs.entities.OgreEntity(a,b));d==16711683&&this.addEntity(new pocjs.entities.BossOgre(a,b));d==16711684&&this.addEntity(new pocjs.entities.EyeEntity(a,b));d==16711685&&this.addEntity(new pocjs.entities.EyeBossEntity(a,b));d==16711686&&this.addEntity(new pocjs.entities.GhostEntity(a,b));d==16711687&&this.addEntity(new pocjs.entities.GhostBossEntity(a,b));if(d==1712392||d==16711687)c.floorTex=7,c.ceilTex=7;if(d==
13027014)c.col=pocjs.Art.getCol(10526880);if(d==13026967)c.col=pocjs.Art.getCol(10526880);if(d==6633984)c.floorCol=pocjs.Art.getCol(11888128),c.floorTex=25;if(d==9699227)c.col=pocjs.Art.getCol(2797363),c.tex=8},getNewBlock:function(a,b,c){return c==9699227?new pocjs.level.block.SolidBlock:c==37632?new pocjs.level.block.PitBlock:c==16777215?new pocjs.level.block.SolidBlock:c==65535?new pocjs.level.block.VanishBlock:c==16777060?new pocjs.level.block.ChestBlock:c==255?new pocjs.level.block.WaterBlock:
c==16726530?new pocjs.level.block.TorchBlock:c==5000268?new pocjs.level.block.BarsBlock:c==16738047?new pocjs.level.block.LadderBlock(!1):c==10354846?new pocjs.level.block.LadderBlock(!0):c==12697933?new pocjs.level.block.LootBlock:c==13027014?new pocjs.level.block.DoorBlock:c==65447?new pocjs.level.block.SwitchBlock:c==37760?new pocjs.level.block.PressurePlateBlock:c==16711685?new pocjs.level.block.IceBlock:c==4144992?new pocjs.level.block.IceBlock:c==13026967?new pocjs.level.block.LockedDoorBlock:
c==16759298?new pocjs.level.block.AltarBlock:c==7639847?new pocjs.level.block.SpiritWallBlock:c==1712392?new pocjs.level.block.Block:c==49831?new pocjs.level.block.FinalUnlockBlock:c==86?new pocjs.level.block.WinBlock:new pocjs.level.block.Block},getBlock:function(a,b){return a<0||b<0||a>=this.width||b>=this.height?this.solidWall:this.blocks[a+b*this.width]},containsBlockingEntity:function(a,b,c,d){for(var j=Math.floor((c+a)/2),l=Math.floor((d+b)/2),m=l-2;m<=l+2;m++)for(var k=j-2;k<=j+2;k++)for(var h=
this.getBlock(k,m).entities,e=0;e<h.length;e++)if(h[e].isInside(a,b,c,d))return!0;return!1},containsBlockingNonFlyingEntity:function(a,b,c,d){for(var j=Math.floor((c+a)/2),l=Math.floor((d+b)/2),m=l-2;m<=l+2;m++)for(var k=j-2;k<=j+2;k++)for(var h=this.getBlock(k,m).entities,e=0;e<h.length;e++){var f=h[e];if(!f.flying&&f.isInside(a,b,c,d))return!0}return!1},tick:function(){for(var a=0;a<this.entities.length;a++){var b=this.entities[a];b.tick();b.updatePos();b.isRemoved()&&(this.entities.splice(a,1),
a--)}for(a=0;a<this.height;a++)for(b=0;b<this.width;b++)this.blocks[b+a*this.width].tick()},trigger:function(a,b){for(var c=0;c<this.height;c++)for(var d=0;d<this.width;d++){var j=this.blocks[d+c*this.width];j.id==a&&j.trigger(b)}},switchLevel:function(){},findSpawn:function(a){for(var b=0;b<this.height;b++)for(var c=0;c<this.width;c++){var d=this.blocks[c+b*this.width];if(d.id==a&&d instanceof pocjs.level.block.LadderBlock)this.xSpawn=c,this.ySpawn=b}},getLoot:function(a){a==20&&this.game.getLoot(pocjs.entities.Item.pistol);
a==21&&this.game.getLoot(pocjs.entities.Item.potion)},win:function(){this.game.win(this.player)},lose:function(){this.game.lose(this.player)},showLootScreen:function(a){this.game.setMenu(new pocjs.menu.GotLootMenu(a))}});
dojo.mixin(pocjs.level.Level,{loaded:{},pixels:{},dims:{},clear:function(){this.loaded={}},loadLevelBitmap:function(a){var b=this,c=new dojo.Deferred;PNG.load("res/level/"+a+".png",function(d){for(var j=d.width,l=d.height,m=Array(j*l<<0),d=d.decodePixels(),k=0;k<l;k++)for(var h=0;h<j;h++){var e=d[k][h];m[h+k*j]=e[3]<<24|e[0]<<16|e[1]<<8|e[2]}b.pixels[a]=m;b.dims[a]={w:j,h:l};c.resolve(a)});return c},loadLevel:function(a,b){if(b in this.loaded)return this.loaded[b];var c=this.byName(b);c.init(a,b,
this.dims[b].w,this.dims[b].h,this.pixels[b]);return this.loaded[b]=c},byName:function(a){a="pocjs.level."+a.slice(0,1).toUpperCase()+a.slice(1)+"Level";return(new dojo.getObject(a))()}});dojo.provide("pocjs.level.CryptLevel");dojo.declare("pocjs.level.CryptLevel",pocjs.level.Level,{constructor:function(){this.wallCol=this.ceilCol=this.floorCol=4210752;this.name="The Crypt"},switchLevel:function(a){a==1&&this.game.switchLevel("overworld",2)},getLoot:function(a){this.inherited(arguments);a==1&&this.game.getLoot(pocjs.entities.Item.flippers)}});
dojo.provide("pocjs.level.DungeonLevel");
dojo.declare("pocjs.level.DungeonLevel",pocjs.level.Level,{constructor:function(){this.wallCol=12994900;this.ceilCol=this.floorCol=9325137;this.name="The Dungeons"},init:function(a,b,c,d,j){this.inherited(arguments);this.inherited("trigger",[6,!0]);this.inherited("trigger",[7,!0])},switchLevel:function(a){a==1&&this.game.switchLevel("start",2)},getLoot:function(a){this.inherited(arguments);a==1&&this.game.getLoot(pocjs.entities.Item.powerGlove)},trigger:function(a,b){this.inherited(arguments);a==
5&&this.inherited("trigger",[6,!b]);a==4&&this.inherited("trigger",[7,!b])}});dojo.provide("pocjs.level.DungeonLevel");
dojo.declare("pocjs.level.DungeonLevel",pocjs.level.Level,{constructor:function(){this.wallCol=12994900;this.ceilCol=this.floorCol=9325137;this.name="The Dungeons"},init:function(a,b,c,d,j){this.inherited(arguments);this.inherited("trigger",[6,!0]);this.inherited("trigger",[7,!0])},switchLevel:function(a){a==1&&this.game.switchLevel("start",2)},getLoot:function(a){this.inherited(arguments);a==1&&this.game.getLoot(pocjs.entities.Item.powerGlove)},trigger:function(a,b){this.inherited(arguments);a==
5&&this.inherited("trigger",[6,!b]);a==4&&this.inherited("trigger",[7,!b])}});dojo.provide("pocjs.level.IceLevel");dojo.declare("pocjs.level.IceLevel",pocjs.level.Level,{constructor:function(){this.floorCol=this.ceilCol=12114912;this.wallCol=7071999;this.name="The Frost Cave"},switchLevel:function(a){a==1&&this.game.switchLevel("overworld",5)},getLoot:function(a){this.inherited(arguments);a==1&&this.game.getLoot(pocjs.entities.Item.skates)}});dojo.provide("pocjs.level.OverworldLevel");
dojo.declare("pocjs.level.OverworldLevel",pocjs.level.Level,{constructor:function(){this.ceilTex=-1;this.floorCol=5276243;this.floorTex=24;this.wallCol=10526880;this.name="The Island"},switchLevel:function(a){a==1&&this.game.switchLevel("start",1);a==2&&this.game.switchLevel("crypt",1);a==3&&this.game.switchLevel("temple",1);a==5&&this.game.switchLevel("ice",1)},getLoot:function(a){this.inherited(arguments);a==1&&this.game.getLoot(pocjs.entities.Item.cutters)}});dojo.provide("pocjs.level.StartLevel");
dojo.declare("pocjs.level.StartLevel",pocjs.level.Level,{constructor:function(){this.name="The Prison"},decorateBlock:function(a,b,c,d){this.inherited(arguments)},getNewBlock:function(a,b,c){return this.inherited(arguments)},switchLevel:function(a){a==1&&this.game.switchLevel("overworld",1);a==2&&this.game.switchLevel("dungeon",1)},getLoot:function(a){this.inherited(arguments)}});dojo.provide("pocjs.level.TempleLevel");
dojo.declare("pocjs.level.TempleLevel",pocjs.level.Level,{triggerMask:0,constructor:function(){this.ceilCol=this.floorCol=9069718;this.wallCol=13610459;this.name="The Temple"},switchLevel:function(a){a==1&&this.game.switchLevel("overworld",3)},getLoot:function(a){this.inherited(arguments);a==1&&this.game.getLoot(pocjs.entities.Item.skates)},trigger:function(a,b){this.triggerMask|=1<<a;this.inherited(arguments);b||(this.triggerMask^=1<<a);this.triggerMask==14?this.inherited(arguments,[1,!0]):this.inherited(arguments,
[1,!1])}});dojo.provide("pocjs.Game");
dojo.declare("pocjs.Game",null,{time:null,level:null,player:null,pauseTime:null,menu:null,constructor:function(){this.setMenu(new pocjs.menu.TitleMenu)},newGame:function(){pocjs.level.Level.clear();this.level=pocjs.level.Level.loadLevel(this,"start");this.player=new pocjs.entities.Player;this.player.level=this.level;this.level.player=this.player;this.player.x=this.level.xSpawn;this.player.z=this.level.ySpawn;this.level.addEntity(this.player);this.player.rot=Math.PI+0.4},switchLevel:function(a,b){this.pauseTime=
30;this.level.removeEntityImmediately(this.player);this.level=pocjs.level.Level.loadLevel(this,a);this.level.findSpawn(b);this.player.x=this.level.xSpawn;this.player.z=this.level.ySpawn;this.level.getBlock(this.level.xSpawn,this.level.ySpawn).wait=!0;this.player.x+=Math.sin(this.player.rot)*0.2;this.player.z+=Math.cos(this.player.rot)*0.2;this.level.addEntity(this.player)},tick:function(a){if(this.pauseTime>0)this.pauseTime--;else{var b="W".charCodeAt(),c="S".charCodeAt(),d="A".charCodeAt(),j="D".charCodeAt(),
l="Q".charCodeAt(),m="E".charCodeAt();this.time++;for(var k=dojo.keys,h=a[k.CTRL]||a[k.ALT]||a[k.META]||a[k.SHIFT],e=a[k.LEFT_ARROW]||a[k.NUMPAD_4],f=a[k.RIGHT_ARROW]||a[k.NUMPAD_6],i=a[b]||a[k.UP_ARROW]||a[k.NUMPAD_8],n=a[c]||a[k.DOWN_ARROW]||a[k.NUMPAD_2],t=a[d]||h&&e,o=a[j]||h&&f,l=a[l]||!h&&e,m=a[m]||!h&&f,h=a[k.SPACE],f=0;f<8;f++)if(a["1".charCodeAt()+f])a["1".charCodeAt()+f]=!1,this.player.selectedSlot=f,this.player.itemUseTime=0;a[k.ESCAPE]&&(a[k.ESCAPE]=!1,this.menu==null&&this.setMenu(new pocjs.menu.PauseMenu));
h&&(a[k.SPACE]=!1);this.menu!=null?(a[b]=a[k.UP_ARROW]=a[k.NUMPAD_8]=!1,a[c]=a[k.DOWN_ARROW]=a[k.NUMPAD_2]=!1,a[d]=!1,a[j]=!1,this.menu.tick(this,i,n,t,o,h)):(this.player.tick(i,n,t,o,l,m),h&&this.player.activate(),this.level.tick())}},getLoot:function(a){this.player.addLoot(a)},win:function(a){this.setMenu(new pocjs.menu.WinMenu(a))},setMenu:function(a){this.menu=a},lose:function(a){this.setMenu(new pocjs.menu.LoseMenu(a))}});dojo.provide("pocjs.gui.Screen");
dojo.declare("pocjs.gui.Screen",pocjs.gui.Bitmap,{PANEL_HEIGHT:29,viewport:null,time:null,constructor:function(a,b){this.viewport=new pocjs.gui.Bitmap3D(a,b-this.PANEL_HEIGHT)},render:function(a){if(a.level==null)this.fill(0,0,this.width,this.height,0);else{var b=a.player.itemUseTime>0,c=a.player.items[a.player.selectedSlot];if(a.pauseTime>0){this.fill(0,0,this.width,this.height,0);for(var b=["Entering "+a.level.name],d=0;d<b.length;d++)this.drawString(b[d],(this.width-b[d].length*6)/2,(this.viewport.height-
b.length*8)/2+d*8+1,1118481),this.drawString(b[d],(this.width-b[d].length*6)/2,(this.viewport.height-b.length*8)/2+d*8,5592388)}else{this.viewport.render(a);this.viewport.postProcess(a.level);var j=a.level.getBlock(a.player.x+0.5<<0,a.player.z+0.5<<0);if(j.messages!=null)for(d=0;d<j.messages.length;d++)this.viewport.drawPart(j.messages[d],(this.width-j.messages[d].length*6)/2,(this.viewport.height-j.messages.length*8)/2+d*8+1,1118481),this.viewport.drawPart(j.messages[d],(this.width-j.messages[d].length*
6)/2,(this.viewport.height-j.messages.length*8)/2+d*8,5592388);this.draw(this.viewport,0,0);d=a.player.turnBob*32<<0;j=Math.sin(a.player.bobPhase*0.4)*1*a.player.bob+a.player.bob*2<<0;b&&(d=j=0);d+=this.width/2<<0;j+=this.height-this.PANEL_HEIGHT-45;c!=pocjs.entities.Item.none&&this.scaleDraw(pocjs.Art.items,3,d,j,16*c.icon+1,17+(b?16:0),15,15,pocjs.Art.getCol(c.color));if(a.player.hurtTime>0||a.player.dead){d=1.5-a.player.hurtTime/30;a.player.dead&&(d=0.5);for(b=0;b<this.pixels.length;b++){var j=
(b%this.width-this.viewport.width/2)/this.width*2,l=(b/this.width-this.viewport.height/2)/this.viewport.height*2;Math.random()+d<Math.sqrt(j*j+l*l)&&(this.pixels[b]=Math.floor(Math.floor(Math.random()*5)/4)*5570560)}}}this.drawPart(pocjs.Art.panel,0,this.height-this.PANEL_HEIGHT,0,0,this.width,this.PANEL_HEIGHT,pocjs.Art.getCol(7368816));this.drawString("\ufffd",3,this.height-26+0,65535);this.drawString(""+a.player.keys+"/4",10,this.height-26+0,16777215);this.drawString("\ufffd",3,this.height-26+
8,16776960);this.drawString(""+a.player.loot,10,this.height-26+8,16777215);this.drawString("\ufffd",3,this.height-26+16,16711680);this.drawString(""+a.player.health,10,this.height-26+16,16777215);for(b=0;b<8;b++)d=a.player.items[b],d!=pocjs.entities.Item.none&&(this.drawPart(pocjs.Art.items,30+b*16,this.height-this.PANEL_HEIGHT+2,d.icon*16,0,16,16,pocjs.Art.getCol(d.color)),d==pocjs.entities.Item.pistol&&(j=""+a.player.ammo,this.drawString(j,b*16+47-j.length*6,this.height-this.PANEL_HEIGHT+11,5592405)),
d==pocjs.entities.Item.potion&&(j=""+a.player.potions,this.drawString(j,b*16+47-j.length*6,this.height-this.PANEL_HEIGHT+11,5592405)));this.drawPart(pocjs.Art.items,30+a.player.selectedSlot*16,this.height-this.PANEL_HEIGHT+2,0,48,17,17,pocjs.Art.getCol(16777215));this.drawString(c.name,26+(128-c.name.length*4)/2,this.height-9,16777215)}if(a.menu!=null){for(b=0;b<this.pixels.length;b++)this.pixels[b]=(this.pixels[b]&16579836)>>2;a.menu.render(this)}}});dojo.provide("pocjs.EscapeComponent");
dojo.declare("pocjs.EscapeComponent",null,{WIDTH:160,HEIGHT:120,SCALE:4,context:null,canvas:null,game:null,screen:null,img:null,pixels:null,input:null,running:!1,lastTime:null,frames:0,inFlight:!1,resizeArray:null,constructor:function(a){this.context=a.getContext("2d");this.canvas=a;a.width=this.WIDTH*this.SCALE;a.height=this.HEIGHT*this.SCALE;var b=this;this.dfd=this.loadResources().then(function(){b.game=new pocjs.Game;b.screen=new pocjs.gui.Screen(b.WIDTH,b.HEIGHT);b.img=b.context.createImageData(a.width,
a.height);b.tmpcanvas=document.createElement("canvas");b.tmpcanvas.width=b.WIDTH;b.tmpcanvas.height=b.HEIGHT;b.tmpctx=b.tmpcanvas.getContext("2d");b.context.mozImageSmoothingEnabled=!1;b.tmpimg=b.tmpctx.createImageData(b.WIDTH,b.HEIGHT);b.input=new pocjs.InputHandler;dojo.connect(document,"onkeyup",b.input,"keyup");dojo.connect(document,"onkeydown",b.input,"keydown");return"done"})},loadResources:function(){var a=[];dojo.byId("status").innerHTML="Loading resources ...";"start crypt ice temple overworld dungeon".split(" ").forEach(function(b){a.push(pocjs.level.Level.loadLevelBitmap(b))});
"walls floors sprites font panel items sky".split(" ").forEach(function(b){a.push(pocjs.Art.loadBitmap(b,"res/tex/"+b+".png"))});a.push(pocjs.Art.loadBitmap("logo","res/gui/logo.png"));"altar bosskill click1 click2 crumble cut death hit hurt2 hurt key kill ladder pickup potion roll shoot slide splash thud treasure".split(" ").forEach(function(b){a.push(pocjs.Sound.loadSound(b))});var b=(new dojo.DeferredList(a)).then(function(a){dojo.byId("status").innerHTML="Done.";return a});this.list=a;return b},
start:function(){var a=this;dojo.create("button",{onclick:"pocjs.__game.stop();",innerHTML:"Stop wild JS"},dojo.body());this.dfd.then(function(){a.running=!0;a.lastTime=Date.now();a.loopHandle=setInterval(function(){a.run()},1E3/60)})},stop:function(){clearInterval(this.loopHandle)},run:function(){if(!this.inFlight){this.inFlight=!0;this.tick();this.render();var a=(Date.now()-this.lastTime)/1E3;if(a>=2)a=this.frames/a<<0,dojo.byId("status").innerHTML=""+a+" FPS",this.frames=0,this.lastTime=Date.now();
this.frames++;this.inFlight=!1}},tick:function(){this.game.tick(this.input.keys)},render:function(){this.screen.render(this.game);for(var a=this.screen.pixels,b=0;b<a.length;b++){var c=a[b],d=b*4;this.tmpimg.data[d]=c>>16&255;this.tmpimg.data[d+1]=c>>8&255;this.tmpimg.data[d+2]=c&255;this.tmpimg.data[d+3]=255}this.tmpctx.putImageData(this.tmpimg,0,0);this.context.drawImage(this.tmpcanvas,0,0,this.WIDTH,this.HEIGHT,0,0,this.WIDTH*this.SCALE,this.HEIGHT*this.SCALE)},resize:function(a){for(var b=this.WIDTH,
c=this.WIDTH*this.SCALE,d=this.HEIGHT*this.SCALE,j=b/c,l=this.HEIGHT/d,m,k,h=0;h<d;h++)for(var e=0;e<c;e++)m=e*j>>>0,k=h*l>>>0,this.resizeArray[h*c+e]=a[k*b+m]}});
